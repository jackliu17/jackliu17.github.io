<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="D3Af5_wNyfCxpGOmu04o8yJ6Y4au_48rBuja2NxHLOs" />










  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="restapi," />





  <link rel="alternate" href="/atom.xml" title="Cowboy Tech" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="Swift JSON Parsing &amp;amp; Networking Calls 101Completion handlersCompletion handlers are super convenient when your app is doing something that might take a little while, like making an API call, and y">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS-app-with-Rest-api">
<meta property="og:url" content="http://jackliu17.github.io/2016/12/08/iOS-app-with-Rest-api/index.html">
<meta property="og:site_name" content="Cowboy Tech">
<meta property="og:description" content="Swift JSON Parsing &amp;amp; Networking Calls 101Completion handlersCompletion handlers are super convenient when your app is doing something that might take a little while, like making an API call, and y">
<meta property="og:updated_time" content="2017-01-27T01:13:45.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS-app-with-Rest-api">
<meta name="twitter:description" content="Swift JSON Parsing &amp;amp; Networking Calls 101Completion handlersCompletion handlers are super convenient when your app is doing something that might take a little while, like making an API call, and y">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://jackliu17.github.io/2016/12/08/iOS-app-with-Rest-api/"/>





  <title> iOS-app-with-Rest-api | Cowboy Tech </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Cowboy Tech</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">The best preparation for tomorrow is doing your best today</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://jackliu17.github.io/2016/12/08/iOS-app-with-Rest-api/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jack Liu">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Cowboy Tech">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Cowboy Tech" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS-app-with-Rest-api
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-08T10:30:17+08:00">
              2016-12-08
            </time>

            &nbsp;|&nbsp;

            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-check-o"></i>
            </span>
            <time title="Post modified" itemprop="dateModified" datetime="2017-01-27T09:13:45+08:00">
              2017-01-27
            </time>
            
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/notes/" itemprop="url" rel="index">
                    <span itemprop="name">notes</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/12/08/iOS-app-with-Rest-api/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/12/08/iOS-app-with-Rest-api/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Swift-JSON-Parsing-amp-Networking-Calls-101"><a href="#Swift-JSON-Parsing-amp-Networking-Calls-101" class="headerlink" title="Swift JSON Parsing &amp; Networking Calls 101"></a>Swift JSON Parsing &amp; Networking Calls 101</h1><h2 id="Completion-handlers"><a href="#Completion-handlers" class="headerlink" title="Completion handlers"></a>Completion handlers</h2><p>Completion handlers are super convenient when your app is doing something that might take a little while, like making an API call, and you need to do something when that task is done, like updating the UI to show the data.we can use them to take action when something is done.</p>
<h3 id="Declare-argument-in-completion-handler"><a href="#Declare-argument-in-completion-handler" class="headerlink" title="Declare argument in completion handler"></a>Declare argument in completion handler</h3><p>The three arguments in the closure (data, response, error) match the arguments in the completion handler declaration: (Data?, URLResponse?, Error?). You can specify the types explicitly when you create your closure but it’s not necessary because the compiler can figure it out</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> task = session.dataTask(with: urlRequest, completionHandler:</span><br><span class="line">&#123; (data: <span class="type">Data</span>?, response: <span class="type">URLResponse</span>?, error: <span class="type">Error</span>?) <span class="keyword">in</span></span><br><span class="line"><span class="comment">// this is where the completion handler code goes</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> response = response &#123;</span><br><span class="line"><span class="built_in">print</span>(response)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line"><span class="built_in">print</span>(error)</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">task.resume()</span><br></pre></td></tr></table></figure>
<h3 id="Trailing-closure-syntax"><a href="#Trailing-closure-syntax" class="headerlink" title="Trailing closure syntax"></a>Trailing closure syntax</h3><p>whenever the last argument for a function is a closure.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> task = session.dataTask(with: urlRequest) &#123; (data, response, error) <span class="keyword">in</span></span><br><span class="line"><span class="comment">// this is where the completion handler code goes</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> response = response &#123;</span><br><span class="line"><span class="built_in">print</span>(response)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line"><span class="built_in">print</span>(error)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">task.resume()</span><br></pre></td></tr></table></figure>
<h3 id="Ignore-arguments"><a href="#Ignore-arguments" class="headerlink" title="Ignore arguments"></a>Ignore arguments</h3><p>If you want to ignore some arguments you can tell the compiler that you don’t want them by replacing them with _</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> task = session.dataTask(with: urlRequest) &#123; (data, <span class="number">_</span>, error) <span class="keyword">in</span></span><br><span class="line"><span class="comment">// can't do print(response) since we don't have response</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line"><span class="built_in">print</span>(error)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">task.resume()</span><br></pre></td></tr></table></figure>
<h3 id="Same-completion-handler-for-multiple-tasks"><a href="#Same-completion-handler-for-multiple-tasks" class="headerlink" title="Same completion handler for multiple tasks"></a>Same completion handler for multiple tasks</h3><p>declare the closure as a variable</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myCompletionHandler: (<span class="type">Data</span>?, <span class="type">URLResponse</span>?, <span class="type">Error</span>?) -&gt; <span class="type">Void</span> = &#123;</span><br><span class="line">(data, response, error) <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// this is where the completion handler code goes</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> response = response &#123;</span><br><span class="line"><span class="built_in">print</span>(response)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line"><span class="built_in">print</span>(error)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> task = session.dataTask(with: urlRequest, completionHandler: myCompletionHandler)</span><br><span class="line">task.resume()</span><br></pre></td></tr></table></figure>
<h2 id="REST-API-Calls-with-URLSession"><a href="#REST-API-Calls-with-URLSession" class="headerlink" title="REST API Calls with URLSession"></a>REST API Calls with URLSession</h2><h3 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. Create url from string</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> todoEndpoint: <span class="type">String</span> = <span class="string">"https://jsonplaceholder.typicode.com/todos/1"</span></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> url = <span class="type">URL</span>(string: todoEndpoint) <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Error: cannot create URL"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. Create URLRequest from url</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> urlRequest = <span class="type">URLRequest</span>(url: url)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. Create URLSession dataTask with completion handler</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> session = <span class="type">URLSession</span>.shared</span><br><span class="line"><span class="keyword">let</span> task = session.dataTask(with: urlRequest) &#123;</span><br><span class="line">(data, response, error) <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.1 Check errors when getting request</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> error == <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"error calling GET on /todos/1"</span>)</span><br><span class="line"><span class="built_in">print</span>(error!)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.2 Check errors when receiving data not nil</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> responseData = data <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Error: did not receive data"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line"><span class="comment">// 3.3 Check errors when converting data to JSON</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> todo = <span class="keyword">try</span> <span class="type">JSONSerialization</span>.jsonObject(with: responseData, options: [])</span><br><span class="line"><span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Any</span>] <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"error trying to convert data to JSON"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The todo is: "</span> + todo.description)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.4 Check errors when get todo title form JSON</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> todoTitle = todo[<span class="string">"title"</span>] <span class="keyword">as</span>? <span class="type">String</span> <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Could not get todo title from JSON"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The title is: "</span> + todoTitle)</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"error trying to convert data to JSON"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. URLSession dataTask call resume </span></span><br><span class="line"></span><br><span class="line">task.resume()</span><br></pre></td></tr></table></figure>
<h3 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. Create url from string</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> todosEndpoint: <span class="type">String</span> = <span class="string">"https://jsonplaceholder.typicode.com/todos"</span></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> todosURL = <span class="type">URL</span>(string: todosEndpoint) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Error: cannot create URL"</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. Create URLRequest from url with specified httpMthod and httpBody</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.1 Create URLRequest</span></span><br><span class="line"><span class="keyword">var</span> todosUrlRequest = <span class="type">URLRequest</span>(url: todosURL)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.2 Set httpMethod </span></span><br><span class="line">todosUrlRequest.httpMethod = <span class="string">"POST"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.3 Set httpBody by converting a dictonary to json</span></span><br><span class="line"><span class="keyword">let</span> newTodo: [<span class="type">String</span>: <span class="type">Any</span>] = [<span class="string">"title"</span>: <span class="string">"My First todo"</span>, <span class="string">"completed"</span>: <span class="literal">false</span>, <span class="string">"userId"</span>: <span class="number">1</span>]</span><br><span class="line"><span class="keyword">let</span> jsonTodo: <span class="type">Data</span>      </span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    jsonTodo = <span class="keyword">try</span> <span class="type">JSONSerialization</span>.data(withJSONObject: newTodo, options: [])</span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Error: cannot create JSON from todo"</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">todosUrlRequest.httpBody = jsonTodo</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. Create URLSession dataTask with completion handler</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> session = <span class="type">URLSession</span>.shared     </span><br><span class="line"><span class="keyword">let</span> task = session.dataTask(with: todosUrlRequest) &#123;</span><br><span class="line">            (data, response, error) <span class="keyword">in</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 3.1 Check errors when getting request</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">guard</span> error == <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"error calling POST on /todos/1"</span>)</span><br><span class="line">                <span class="built_in">print</span>(error!)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 3.2 Check errors when receiving data not nil</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> responseData = data <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Error: did not receive data"</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">      </span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="comment">// 3.3 Check errors when converting data to JSON</span></span><br><span class="line">  			 <span class="keyword">guard</span> <span class="keyword">let</span> receivedTodo = <span class="keyword">try</span> <span class="type">JSONSerialization</span>.jsonObject(with: responseData,</span><br><span class="line">                                                          	options: []) <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Any</span>] 				 <span class="keyword">else</span> &#123;</span><br><span class="line">             <span class="built_in">print</span>(<span class="string">"Could not get JSON from responseData as dictionary"</span>)</span><br><span class="line">                  <span class="keyword">return</span></span><br><span class="line">             &#125;</span><br><span class="line">             <span class="built_in">print</span>(<span class="string">"The todo is: "</span> + receivedTodo.description)</span><br><span class="line">              </span><br><span class="line">        <span class="comment">// 3.4 Check errors when get todo title form JSON</span></span><br><span class="line">             <span class="keyword">guard</span> <span class="keyword">let</span> todoID = receivedTodo[<span class="string">"id"</span>] <span class="keyword">as</span>? <span class="type">Int</span> <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">"Could not get todoID as int from JSON"</span>)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">             &#125;</span><br><span class="line">             <span class="built_in">print</span>(<span class="string">"The ID is: \(todoID)"</span>)</span><br><span class="line">                </span><br><span class="line">          &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"error parsing response from POST on /todos"</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. URLSession dataTask call resume </span></span><br><span class="line">        task.resume()</span><br></pre></td></tr></table></figure>
<h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. Create url from string</span></span><br><span class="line"><span class="keyword">let</span> firstTodoEndpoint: <span class="type">String</span> = <span class="string">"https://jsonplaceholder.typicode.com/todos/1"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. Create URLRequest with specified httpMethod </span></span><br><span class="line"><span class="keyword">var</span> firstTodoUrlRequest = <span class="type">URLRequest</span>(url: <span class="type">URL</span>(string: firstTodoEndpoint)!)</span><br><span class="line">firstTodoUrlRequest.httpMethod = <span class="string">"DELETE"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. Create URLSession dataTask with completion handler</span></span><br><span class="line"><span class="keyword">let</span> session = <span class="type">URLSession</span>.shared</span><br><span class="line"><span class="keyword">let</span> task = session.dataTask(with: firstTodoUrlRequest) &#123;</span><br><span class="line">    (data, response, error) <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> <span class="number">_</span> = data <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"error calling DELETE on /todos/1"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"DELETE ok"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. URLSession dataTask call resume</span></span><br><span class="line">task.resume()</span><br></pre></td></tr></table></figure>
<h2 id="REST-API-Calls-with-Alamofire"><a href="#REST-API-Calls-with-Alamofire" class="headerlink" title="REST API Calls with Alamofire"></a>REST API Calls with Alamofire</h2><h3 id="Response-result-isSucces"><a href="#Response-result-isSucces" class="headerlink" title="Response.result.isSucces"></a>Response.result.isSucces</h3><p>You can use response.result.isSuccess if you just need to know whether the call succeeded or failed</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> todoEndpoint: <span class="type">String</span> = <span class="string">"https://jsonplaceholder.typicode.com/todos/1"</span></span><br><span class="line"><span class="type">Alamofire</span>.request(todoEndpoint).responseJSON &#123; response <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> response.result.isSuccess <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// handle failure</span></span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// handle success</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="GET-1"><a href="#GET-1" class="headerlink" title="GET"></a>GET</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. Create endpoint</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> todoEndpoint: <span class="type">String</span> = <span class="string">"https://jsonplaceholder.typicode.com/todos/1"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. Alamofire.request.responseJSON method call</span></span><br><span class="line"></span><br><span class="line"><span class="type">Alamofire</span>.request(todoEndpoint).responseJSON &#123; response <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.1 Check for error returned by the API call</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> response.result.error == <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"error calling GET on /todos/1"</span>)</span><br><span class="line"><span class="built_in">print</span>(response.result.error!)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.2 Check for error in the JSON transformation</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> json = response.result.value <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Any</span>] <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"didn't get todo object as JSON from API"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Error: \(response.result.error)"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.3 Check to see if access the todo object in the JSON</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> todoTitle = json[<span class="string">"title"</span>] <span class="keyword">as</span>? <span class="type">String</span> <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Could not get todo title from JSON"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The title is: "</span> + todoTitle)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="POST-1"><a href="#POST-1" class="headerlink" title="POST"></a>POST</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. Create endpoint &amp; passing parameter</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> todosEndpoint: <span class="type">String</span> = <span class="string">"https://jsonplaceholder.typicode.com/todos"</span></span><br><span class="line"><span class="keyword">let</span> newTodo: [<span class="type">String</span>: <span class="type">Any</span>] = [<span class="string">"title"</span>: <span class="string">"My First Post"</span>, <span class="string">"completed"</span>: <span class="number">0</span>, <span class="string">"userId"</span>: <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. Alamofire.request.responseJSON method call</span></span><br><span class="line"></span><br><span class="line"><span class="type">Alamofire</span>.request(todosEndpoint, method: .post, parameters: newTodo,encoding: <span class="type">JSONEncoding</span>.<span class="keyword">default</span>)</span><br><span class="line">.responseJSON &#123; response <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.1 Check for error returned by the API call</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> response.result.error == <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"error calling POST on /todos/1"</span>)</span><br><span class="line"><span class="built_in">print</span>(response.result.error!)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.2 Check for error in the JSON transformation</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> json = response.result.value <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Any</span>] <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"didn't get todo object as JSON from API"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Error: \(response.result.error)"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.3 Check to see if access the todo object in the JSON</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> todoTitle = json[<span class="string">"title"</span>] <span class="keyword">as</span>? <span class="type">String</span> <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Could not get todo title from JSON"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The title is: "</span> + todoTitle)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="DELETE-1"><a href="#DELETE-1" class="headerlink" title="DELETE"></a>DELETE</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> firstTodoEndpoint: <span class="type">String</span> = <span class="string">"https://jsonplaceholder.typicode.com/todos/1"</span></span><br><span class="line"></span><br><span class="line"><span class="type">Alamofire</span>.request(firstTodoEndpoint, method: .delete).responseJSON &#123; response <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> response.result.error == <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"error calling DELETE on /todos/1"</span>)</span><br><span class="line"><span class="built_in">print</span>(response.result.error!)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"DELETE ok"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Using-Alamofire-Router"><a href="#Using-Alamofire-Router" class="headerlink" title="Using Alamofire Router"></a>Using Alamofire Router</h2><h3 id="Alamofire-struct-Result-vs-Response"><a href="#Alamofire-struct-Result-vs-Response" class="headerlink" title="Alamofire struct Result vs. Response"></a>Alamofire struct Result vs. Response</h3><ol>
<li>Result has .success and .failure cases and might have what you asked for or an error. </li>
<li>Response is higher level: it packs up the Result along with all of the other info from the transaction like your original request and the raw response</li>
</ol>
<h3 id="1-Creating-URL-request-by-TodoRouter"><a href="#1-Creating-URL-request-by-TodoRouter" class="headerlink" title="1. Creating URL request by TodoRouter"></a>1. Creating URL request by TodoRouter</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TodoRouter.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">import</span> Alamofire</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">TodoRouter</span>: <span class="title">URLRequestConvertible</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 1. Base URL</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> baseURLString = <span class="string">"https://jsonplaceholder.typicode.com/"</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. Http Method Case with parameters</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">get</span>(<span class="type">Int</span>)</span><br><span class="line">    <span class="keyword">case</span> create([<span class="type">String</span>: <span class="type">Any</span>])</span><br><span class="line">    <span class="keyword">case</span> delete(<span class="type">Int</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3. Return a URL request</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">asURLRequest</span><span class="params">()</span></span> <span class="keyword">throws</span> -&gt; <span class="type">URLRequest</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3.1 Variable for enum HTTPMethod</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> method: <span class="type">HTTPMethod</span> &#123;</span><br><span class="line">            <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">            <span class="keyword">case</span> .<span class="keyword">get</span>:</span><br><span class="line">                <span class="keyword">return</span> .<span class="keyword">get</span></span><br><span class="line">            <span class="keyword">case</span> .create:</span><br><span class="line">                <span class="keyword">return</span> .post</span><br><span class="line">            <span class="keyword">case</span> .delete:</span><br><span class="line">                <span class="keyword">return</span> .delete</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.2 Variable for parameters</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> params: ([<span class="type">String</span>: <span class="type">Any</span>]?) = &#123;</span><br><span class="line">            <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">            <span class="keyword">case</span> .<span class="keyword">get</span>, .delete:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            <span class="keyword">case</span> .create(<span class="keyword">let</span> newTodo):</span><br><span class="line">                <span class="keyword">return</span> (newTodo)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;()</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3.3 Variable for url</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> url: <span class="type">URL</span> = &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> relativePath: <span class="type">String</span>?</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">            <span class="keyword">case</span> .<span class="keyword">get</span>(<span class="keyword">let</span> number):          </span><br><span class="line">                relativePath = <span class="string">"todos/\(number)"</span>       </span><br><span class="line">            <span class="keyword">case</span> .create:       </span><br><span class="line">                relativePath = <span class="string">"todos"</span>          </span><br><span class="line">            <span class="keyword">case</span> .delete(<span class="keyword">let</span> number):          </span><br><span class="line">                relativePath = <span class="string">"todos/\(number)"</span></span><br><span class="line">            &#125;</span><br><span class="line">           </span><br><span class="line">            <span class="keyword">var</span> url = <span class="type">URL</span>(string: <span class="type">TodoRouter</span>.baseURLString)!        </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> relativePath = relativePath &#123;</span><br><span class="line">                url = url.appendingPathComponent(relativePath)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> url</span><br><span class="line">        &#125;()</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3.4 Create urlRequest with url</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> urlRequest = <span class="type">URLRequest</span>(url: url)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3.5 Set url with httpMethod</span></span><br><span class="line">        </span><br><span class="line">        urlRequest.httpMethod = method.rawValue</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3.6 JSON encoding with urlRequest and parameters</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> encoding = <span class="type">JSONEncoding</span>.<span class="keyword">default</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">try</span> encoding.encode(urlRequest, with: params)</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-Todo-JSON-Object-Mapping"><a href="#2-Todo-JSON-Object-Mapping" class="headerlink" title="2. Todo - JSON Object Mapping"></a>2. Todo - JSON Object Mapping</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//- Todo.swift</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> title: <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// id is optional because it won’t have an ID until it’s been saved to the server</span></span><br><span class="line">    <span class="keyword">var</span> id: <span class="type">Int</span>?</span><br><span class="line">    <span class="keyword">var</span> userId: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> completed: <span class="type">Bool</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(title: <span class="type">String</span>, id: <span class="type">Int</span>?, userId: <span class="type">Int</span>, completedStatus: <span class="type">Bool</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.title = title</span><br><span class="line">        <span class="keyword">self</span>.id = id</span><br><span class="line">        <span class="keyword">self</span>.userId = userId</span><br><span class="line">        <span class="keyword">self</span>.completed = completedStatus</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// handy for debugging</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">description</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"ID: \(self.id), "</span> +</span><br><span class="line">            <span class="string">"User ID: \(self.userId)"</span> +</span><br><span class="line">            <span class="string">"Title: \(self.title)\n"</span> +</span><br><span class="line">        <span class="string">"Completed: \(self.completed)\n"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-Todo-Networking"><a href="#3-Todo-Networking" class="headerlink" title="3. Todo Networking"></a>3. Todo Networking</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//- Todo+Networking.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Alamofire</span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom Error type</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">BackendError</span>: <span class="title">Error</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> objectSerialization(reason: <span class="type">String</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Todo</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 1. Create a Todo object from JSON</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">convenience</span> <span class="keyword">init</span>?(json: [<span class="type">String</span>: <span class="type">Any</span>]) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1.1 Check errors when getting data from dictionary</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> title = json[<span class="string">"title"</span>] <span class="keyword">as</span>? <span class="type">String</span>,</span><br><span class="line">            <span class="keyword">let</span> userId = json[<span class="string">"userId"</span>] <span class="keyword">as</span>? <span class="type">Int</span>,</span><br><span class="line">            <span class="keyword">let</span> completed = json[<span class="string">"completed"</span>] <span class="keyword">as</span>? <span class="type">Bool</span></span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1.2 id can be nil so don't need guard statement</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> idValue = json[<span class="string">"id"</span>] <span class="keyword">as</span>? <span class="type">Int</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1.3 Existing initializer to create a Todo</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(title: title, id: idValue, userId: userId, completedStatus: completed)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. Turn a Todo into a dictionary with String keys</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">toJSON</span><span class="params">()</span></span> -&gt; [<span class="type">String</span>: <span class="type">Any</span>] &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> json = [<span class="type">String</span>: <span class="type">Any</span>]()</span><br><span class="line">        </span><br><span class="line">        json[<span class="string">"title"</span>] = title</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> id = id &#123;</span><br><span class="line">            json[<span class="string">"id"</span>] = id</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        json[<span class="string">"userId"</span>] = userId</span><br><span class="line">        </span><br><span class="line">        json[<span class="string">"completed"</span>] = completed</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> json</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">// 3. Get Request</span></span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">todoByID</span>(<span class="title">id</span>: <span class="title">Int</span>, <span class="title">completionHandler</span>: @<span class="title">escaping</span> (<span class="title">Result</span>&lt;<span class="title">Todo</span>&gt;) -&gt; <span class="title">Void</span>) </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3.1 Call Alamofire</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">Alamofire</span>.request(<span class="type">TodoRouter</span>.<span class="keyword">get</span>(id))</span><br><span class="line">            .responseJSON &#123; response <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">let</span> result = <span class="type">Todo</span>.todoFromResponse(response: response)</span><br><span class="line">                completionHandler(result)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 4. POST Request</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// (Result&lt;Todo&gt;) -&gt; Void = (Todo?, Error?) -&gt; Void</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">save</span><span class="params">(completionHandler: @escaping <span class="params">(Result&lt;Todo&gt;)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4.1 Turn self to a dictionary</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> fields = <span class="keyword">self</span>.toJSON()</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4.2 Call Alamofire</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">Alamofire</span>.request(<span class="type">TodoRouter</span>.create(fields))</span><br><span class="line">            .responseJSON &#123; response <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">let</span> result = <span class="type">Todo</span>.todoFromResponse(response: response)</span><br><span class="line">                completionHandler(result)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 5. Encapsulation of part of the calling method</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">todoFromResponse</span>(<span class="title">response</span>: <span class="title">DataResponse</span>&lt;<span class="title">Any</span>&gt;) -&gt; <span class="title">Result</span>&lt;<span class="title">Todo</span>&gt; </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 5.1 check error when making request call</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">guard</span> response.result.error == <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(response.result.error!)</span><br><span class="line">            <span class="keyword">return</span> .failure(response.result.error!)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 5.2 check error when unwrap json data as dictionary</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> json = response.result.value <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Any</span>] <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"didn't get todo object as JSON from API"</span>)</span><br><span class="line">            <span class="keyword">return</span> .failure(<span class="type">BackendError</span>.objectSerialization(reason:</span><br><span class="line">                <span class="string">"Did not get JSON dictionary in response"</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 5.3 check error when turning json into todo object</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> todo = <span class="type">Todo</span>(json: json) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> .failure(<span class="type">BackendError</span>.objectSerialization(reason:</span><br><span class="line">                <span class="string">"Could not create Todo object from JSON"</span>))</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> .success(todo)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-Todo-call-in-viewcontroller"><a href="#4-Todo-call-in-viewcontroller" class="headerlink" title="4. Todo call in viewcontroller"></a>4. Todo call in viewcontroller</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">viewdidload</span><span class="params">()</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// 1. Get request call with id</span></span><br><span class="line">        </span><br><span class="line">        <span class="type">Todo</span>.todoByID(id: <span class="number">1</span>) &#123; result <span class="keyword">in</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 1. Check error when making request call</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> error = result.error &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"error calling POST on /todos/"</span>)</span><br><span class="line">                <span class="built_in">print</span>(error)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">       </span><br><span class="line">            <span class="comment">// 1.2 Check error when unwraping value</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> todo = result.value <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"error calling POST on /todos/ - result is nil"</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 1.3 Do something when success!</span></span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(todo.description())</span><br><span class="line">            <span class="built_in">print</span>(todo.title)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. Create new todo</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> newTodo = <span class="type">Todo</span>(title: <span class="string">"My first todo"</span>,</span><br><span class="line">                                 id: <span class="literal">nil</span>,</span><br><span class="line">                                 userId: <span class="number">1</span>,</span><br><span class="line">                                 completedStatus: <span class="literal">true</span>) <span class="keyword">else</span> &#123;</span><br><span class="line">                                    <span class="built_in">print</span>(<span class="string">"error: newTodo isn't a Todo"</span>)</span><br><span class="line">                                    <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. Post request call</span></span><br><span class="line">        </span><br><span class="line">        newTodo.save &#123; result <span class="keyword">in</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 3.1 Check error when making request call</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">guard</span> result.error == <span class="literal">nil</span> <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"error calling POST on /todos/"</span>)</span><br><span class="line">                <span class="built_in">print</span>(result.error!)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 3.2 Check error when unwraping value</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> todo = result.value <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"error calling POST on /todos/. result is nil"</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 3.3 Do something when success!</span></span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(todo.description())</span><br><span class="line">            <span class="built_in">print</span>(todo.title)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h1 id="Custom-HTTP-Headers"><a href="#Custom-HTTP-Headers" class="headerlink" title="Custom HTTP Headers"></a>Custom HTTP Headers</h1><p>Four ways to add HTTP headers to an Alamofire request</p>
<h2 id="Per-Request-Headers"><a href="#Per-Request-Headers" class="headerlink" title="Per Request Headers"></a>Per Request Headers</h2><p>when you only need to pass a header for a single call.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">typealias</span> <span class="type">HTTPHeaders</span> = [<span class="type">String</span>: <span class="type">String</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> headers: <span class="type">HTTPHeaders</span> = [<span class="string">"Accept"</span>: <span class="string">"application/json"</span>]</span><br><span class="line"><span class="keyword">let</span> urlString = <span class="string">"https://api.github.com/gists"</span></span><br><span class="line"></span><br><span class="line"><span class="type">Alamofire</span>.request(urlString, headers: headers).responseJSON &#123; </span><br><span class="line"></span><br><span class="line">response <span class="keyword">in</span></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">debugPrint</span>(request)</span><br></pre></td></tr></table></figure>
<h2 id="Session-Custom-Headers"><a href="#Session-Custom-Headers" class="headerlink" title="Session Custom Headers"></a>Session Custom Headers</h2><p>Some headers are commonly send with every request to an API, like an API key or the Accept header. So it makes sense to set those headers once for the whole session</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get the default headers</span></span><br><span class="line"><span class="keyword">var</span> headers = <span class="type">Alamofire</span>.<span class="type">SessionManager</span>.defaultHTTPHeaders</span><br><span class="line"></span><br><span class="line"><span class="comment">// add your custom header</span></span><br><span class="line">headers[<span class="string">"API-Version"</span>] = <span class="string">"2.0"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// create a custom session configuration</span></span><br><span class="line"><span class="keyword">let</span> configuration = <span class="type">URLSessionConfiguration</span>.<span class="keyword">default</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// add the headers</span></span><br><span class="line">configuration.httpAdditionalHeaders = headers</span><br><span class="line"></span><br><span class="line"><span class="comment">// create a session manager with the configuration</span></span><br><span class="line"><span class="keyword">let</span> sessionManager = <span class="type">Alamofire</span>.<span class="type">SessionManager</span>(configuration: configuration)</span><br><span class="line"></span><br><span class="line">sessionManager.request(...)</span><br></pre></td></tr></table></figure>
<h2 id="Headers-in-URLRequestConvertible"><a href="#Headers-in-URLRequestConvertible" class="headerlink" title="Headers in URLRequestConvertible"></a>Headers in URLRequestConvertible</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">HTTPMethod</span>: <span class="title">String</span> </span>&#123;</span><br><span class="line"><span class="keyword">case</span> options = <span class="string">"OPTIONS"</span></span><br><span class="line"><span class="keyword">case</span> <span class="keyword">get</span> = <span class="string">"GET"</span></span><br><span class="line"><span class="keyword">case</span> head = <span class="string">"HEAD"</span></span><br><span class="line"><span class="keyword">case</span> post = <span class="string">"POST"</span></span><br><span class="line"><span class="keyword">case</span> put = <span class="string">"PUT"</span></span><br><span class="line"><span class="keyword">case</span> patch = <span class="string">"PATCH"</span></span><br><span class="line"><span class="keyword">case</span> delete = <span class="string">"DELETE"</span></span><br><span class="line"><span class="keyword">case</span> trace = <span class="string">"TRACE"</span></span><br><span class="line"><span class="keyword">case</span> connect = <span class="string">"CONNECT"</span></span><br><span class="line">&#125;</span><br><span class="line">............</span><br><span class="line"><span class="keyword">var</span> urlRequest = <span class="type">URLRequest</span>(url: url)</span><br><span class="line">urlRequest.httpMethod = method.rawValue</span><br><span class="line">urlRequest.setValue(<span class="string">"application/json"</span>, forHTTPHeaderField: <span class="string">"Accept"</span>)</span><br><span class="line"><span class="keyword">let</span> encoding = <span class="type">JSONEncoding</span>.<span class="keyword">default</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">try</span> encoding.encode(urlRequest, with: params)</span><br></pre></td></tr></table></figure>
<h2 id="Request-Adapter"><a href="#Request-Adapter" class="headerlink" title="Request Adapter"></a>Request Adapter</h2><p>This approach is useful for handling headers like authorization tokens. It’s a good choice if you’re not already explicitly creating a URLRequest for each call or if you’re generating requests in a few different places but they all need to share some headers</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GistHeadersAdapter</span>: <span class="title">RequestAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">adapt</span><span class="params">(<span class="number">_</span> urlRequest: URLRequest)</span></span> <span class="keyword">throws</span> -&gt; <span class="type">URLRequest</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> urlRequest = urlRequest</span><br><span class="line">	urlRequest.setValue(<span class="string">"application/json"</span>, forHTTPHeaderField: <span class="string">"Accept"</span>)</span><br><span class="line">	<span class="keyword">return</span> urlRequest</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// get a session manager and add the request adapter</span></span><br><span class="line"><span class="keyword">let</span> sessionManager = <span class="type">Alamofire</span>.<span class="type">SessionManager</span>.<span class="keyword">default</span></span><br><span class="line">sessionManager.adapter = <span class="type">GistHeadersAdapter</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// make calls with the session manager</span></span><br><span class="line"><span class="keyword">let</span> request = sessionManager.request(<span class="string">"https://api.github.com/gists"</span>)</span><br><span class="line">.responseJSON &#123; response <span class="keyword">in</span></span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">let</span> response = response &#123;</span><br><span class="line">	<span class="built_in">debugPrint</span>(response)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">debugPrint</span>(request)</span><br></pre></td></tr></table></figure>
<h1 id="Pagination-a-k-a-Load-More-on-Scroll"><a href="#Pagination-a-k-a-Load-More-on-Scroll" class="headerlink" title="Pagination, a.k.a., Load More on Scroll"></a>Pagination, a.k.a., Load More on Scroll</h1><h2 id="map"><a href="#map" class="headerlink" title=".map"></a>.map</h2><p>$0 is a placeholder in those operations that represents whatever we’re doing the operation on.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">let</span> newArray = array.<span class="built_in">map</span> &#123; <span class="type">String</span>($<span class="number">0</span>) &#125;</span><br></pre></td></tr></table></figure>
<p>Could be written like this:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">let</span> newArray = array.<span class="built_in">map</span> &#123; element <span class="keyword">in</span></span><br><span class="line">	<span class="keyword">return</span> <span class="type">String</span>(element)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>map loops through the array and applies that operation to each element. So it’s equivalent to this code:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">var</span> newArray: [<span class="type">String</span>] = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> array &#123;</span><br><span class="line"><span class="keyword">let</span> newElement = <span class="type">String</span>(element)</span><br><span class="line">	newArray.append(newElement)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Basic-Authentication"><a href="#Basic-Authentication" class="headerlink" title="Basic Authentication"></a>Basic Authentication</h1><p>Basic auth requires setting an Authorization header that contains our username:password with base64 encoding</p>
<h2 id="Base64-encoding"><a href="#Base64-encoding" class="headerlink" title="Base64 encoding"></a>Base64 encoding</h2><p>Base64 encoding is a fairly simple way of encoding binary data to send it as text. This type of encoding doesn’t provide additional security since it’s an encoding, not an encryption. So why is it used in basic auth when the username and password are already text? Mostly to encode any odd characters that might cause issues with the HTTP request</p>
<h2 id="Method-1-Alamofire-authenticate-function"><a href="#Method-1-Alamofire-authenticate-function" class="headerlink" title="Method 1. Alamofire .authenticate function"></a>Method 1. Alamofire .authenticate function</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">doGetWithBasicAuth</span><span class="params">()</span></span> -&gt; <span class="type">Void</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> username = <span class="string">"myUsername"</span></span><br><span class="line">        <span class="keyword">let</span> password = <span class="string">"myPassword"</span></span><br><span class="line">        <span class="type">Alamofire</span>.request(<span class="string">"https://httpbin.org/basic-auth/\(username)/\(password)"</span>)</span><br><span class="line">            .authenticate(user: username, password: password)</span><br><span class="line">            .responseString &#123; response <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">let</span> receivedString = response.result.value &#123;</span><br><span class="line">                    <span class="built_in">print</span>(receivedString)</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="keyword">let</span> error = response.result.error &#123;</span><br><span class="line">                    <span class="built_in">print</span>(error)</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="Method-2-URLCredential"><a href="#Method-2-URLCredential" class="headerlink" title="Method 2. URLCredential"></a>Method 2. URLCredential</h2><p>Using a credential lets you specify how long the authentication should live (one call, one session or forever) in the persistence: argument. It also works with certificate-based authentication, if you’re headed down that road.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">doGetWithBasicAuthCredential</span><span class="params">()</span></span> -&gt; <span class="type">Void</span> &#123;</span><br><span class="line">       <span class="keyword">let</span> username = <span class="string">"myUsername"</span></span><br><span class="line">       <span class="keyword">let</span> password = <span class="string">"myPassword"</span>    </span><br><span class="line">       <span class="keyword">let</span> credential = <span class="type">URLCredential</span>(user: username, password: password,</span><br><span class="line">                                      persistence: .forSession) </span><br><span class="line">       <span class="type">Alamofire</span>.request(<span class="string">"https://httpbin.org/basic-auth/\(username)/\(password)"</span>)</span><br><span class="line">           .authenticate(usingCredential: credential)</span><br><span class="line">           .responseString &#123; response <span class="keyword">in</span></span><br><span class="line">               <span class="keyword">if</span> <span class="keyword">let</span> receivedString = response.result.value &#123;</span><br><span class="line">                   <span class="built_in">print</span>(receivedString)</span><br><span class="line">               &#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="keyword">let</span> error = response.result.error &#123;</span><br><span class="line">                   <span class="built_in">print</span>(error)</span><br><span class="line">               &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h2 id="HTTP-Header-Authentication"><a href="#HTTP-Header-Authentication" class="headerlink" title="HTTP Header Authentication"></a>HTTP Header Authentication</h2><p>Puts the params in the URL like ?term=hipster. So use a router to create the URL requests and include the header.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">................</span><br><span class="line"><span class="keyword">var</span> urlRequest = <span class="type">URLRequest</span>(url: url)</span><br><span class="line">urlRequest.httpMethod = method.rawValue</span><br><span class="line"></span><br><span class="line"><span class="comment">// The "X-Mashape-Key": "MY_API_KEY" header will get passed with every request generated by the router.</span></span><br><span class="line"></span><br><span class="line">urlRequest.setValue(<span class="string">"MY_API_KEY"</span>, forHTTPHeaderField: <span class="string">"X-Mashape-Key"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// use URL encoding for the parameters</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> encoding = <span class="type">URLEncoding</span>.<span class="keyword">default</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">try</span> encoding.encode(urlRequest, with: params)</span><br><span class="line">................</span><br></pre></td></tr></table></figure>
<p>make the API call</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Alamofire</span>.request(<span class="type">MashapeRouter</span>.getDefinition(<span class="string">"hipster"</span>))</span><br><span class="line">.responseString &#123; response <span class="keyword">in</span></span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">let</span> response = response &#123;</span><br><span class="line">	<span class="built_in">print</span>(response)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Alamofire-Validation"><a href="#Alamofire-Validation" class="headerlink" title="Alamofire Validation"></a>Alamofire Validation</h2><p>The .validate() call only fails if the content-type of the response isn’t what we expect or the status code isn’t 200-299. That can be useful but sometimes we’re better off examining the JSON that the API returns for error messages.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Alamofire</span>.request(<span class="type">GistRouter</span>.getMyStarred())</span><br><span class="line">.validate()</span><br><span class="line">.responseString &#123; response <span class="keyword">in</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="OAuth-2-0"><a href="#OAuth-2-0" class="headerlink" title="OAuth 2.0"></a>OAuth 2.0</h1><h2 id="OAuth-2-0-authentication-flow"><a href="#OAuth-2-0-authentication-flow" class="headerlink" title="OAuth 2.0 authentication flow"></a>OAuth 2.0 authentication flow</h2><ol>
<li>The app sends you to Twitter to login</li>
<li>You login to Twitter to authorize the app (possibly giving it specific limited permissions)</li>
<li>Twitter sends you back to the app with a token for that app to use</li>
</ol>
<h2 id="The-OAuth-Login-Flow-Github"><a href="#The-OAuth-Login-Flow-Github" class="headerlink" title="The OAuth Login Flow - Github"></a>The OAuth Login Flow - Github</h2><ol>
<li>Redirect users to request GitHub access</li>
<li>GitHub redirects back to your site (app for us) with a code</li>
<li>Exchange the code for an access token</li>
<li>Use the access token to access the API</li>
</ol>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/restapi/" rel="tag"># restapi</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/12/04/Front-end-development-FCC/" rel="next" title="Front-end-development-FCC">
                <i class="fa fa-chevron-left"></i> Front-end-development-FCC
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/12/27/1.A Swift Tour/" rel="prev" title="1.A Swift Tour">
                1.A Swift Tour <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Jack Liu" />
          <p class="site-author-name" itemprop="name">Jack Liu</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">30</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Swift-JSON-Parsing-amp-Networking-Calls-101"><span class="nav-number">1.</span> <span class="nav-text">Swift JSON Parsing & Networking Calls 101</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Completion-handlers"><span class="nav-number">1.1.</span> <span class="nav-text">Completion handlers</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Declare-argument-in-completion-handler"><span class="nav-number">1.1.1.</span> <span class="nav-text">Declare argument in completion handler</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Trailing-closure-syntax"><span class="nav-number">1.1.2.</span> <span class="nav-text">Trailing closure syntax</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ignore-arguments"><span class="nav-number">1.1.3.</span> <span class="nav-text">Ignore arguments</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Same-completion-handler-for-multiple-tasks"><span class="nav-number">1.1.4.</span> <span class="nav-text">Same completion handler for multiple tasks</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#REST-API-Calls-with-URLSession"><span class="nav-number">1.2.</span> <span class="nav-text">REST API Calls with URLSession</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET"><span class="nav-number">1.2.1.</span> <span class="nav-text">GET</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#POST"><span class="nav-number">1.2.2.</span> <span class="nav-text">POST</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DELETE"><span class="nav-number">1.2.3.</span> <span class="nav-text">DELETE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#REST-API-Calls-with-Alamofire"><span class="nav-number">1.3.</span> <span class="nav-text">REST API Calls with Alamofire</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Response-result-isSucces"><span class="nav-number">1.3.1.</span> <span class="nav-text">Response.result.isSucces</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GET-1"><span class="nav-number">1.3.2.</span> <span class="nav-text">GET</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#POST-1"><span class="nav-number">1.3.3.</span> <span class="nav-text">POST</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DELETE-1"><span class="nav-number">1.3.4.</span> <span class="nav-text">DELETE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Using-Alamofire-Router"><span class="nav-number">1.4.</span> <span class="nav-text">Using Alamofire Router</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Alamofire-struct-Result-vs-Response"><span class="nav-number">1.4.1.</span> <span class="nav-text">Alamofire struct Result vs. Response</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Creating-URL-request-by-TodoRouter"><span class="nav-number">1.4.2.</span> <span class="nav-text">1. Creating URL request by TodoRouter</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Todo-JSON-Object-Mapping"><span class="nav-number">1.4.3.</span> <span class="nav-text">2. Todo - JSON Object Mapping</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Todo-Networking"><span class="nav-number">1.4.4.</span> <span class="nav-text">3. Todo Networking</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Todo-call-in-viewcontroller"><span class="nav-number">1.4.5.</span> <span class="nav-text">4. Todo call in viewcontroller</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Custom-HTTP-Headers"><span class="nav-number">2.</span> <span class="nav-text">Custom HTTP Headers</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Per-Request-Headers"><span class="nav-number">2.1.</span> <span class="nav-text">Per Request Headers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Session-Custom-Headers"><span class="nav-number">2.2.</span> <span class="nav-text">Session Custom Headers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Headers-in-URLRequestConvertible"><span class="nav-number">2.3.</span> <span class="nav-text">Headers in URLRequestConvertible</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Request-Adapter"><span class="nav-number">2.4.</span> <span class="nav-text">Request Adapter</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Pagination-a-k-a-Load-More-on-Scroll"><span class="nav-number">3.</span> <span class="nav-text">Pagination, a.k.a., Load More on Scroll</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#map"><span class="nav-number">3.1.</span> <span class="nav-text">.map</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Basic-Authentication"><span class="nav-number">4.</span> <span class="nav-text">Basic Authentication</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Base64-encoding"><span class="nav-number">4.1.</span> <span class="nav-text">Base64 encoding</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Method-1-Alamofire-authenticate-function"><span class="nav-number">4.2.</span> <span class="nav-text">Method 1. Alamofire .authenticate function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Method-2-URLCredential"><span class="nav-number">4.3.</span> <span class="nav-text">Method 2. URLCredential</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-Header-Authentication"><span class="nav-number">4.4.</span> <span class="nav-text">HTTP Header Authentication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Alamofire-Validation"><span class="nav-number">4.5.</span> <span class="nav-text">Alamofire Validation</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#OAuth-2-0"><span class="nav-number">5.</span> <span class="nav-text">OAuth 2.0</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#OAuth-2-0-authentication-flow"><span class="nav-number">5.1.</span> <span class="nav-text">OAuth 2.0 authentication flow</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#The-OAuth-Login-Flow-Github"><span class="nav-number">5.2.</span> <span class="nav-text">The OAuth Login Flow - Github</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jack Liu</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'cowboyTech';
      var disqus_identifier = '2016/12/08/iOS-app-with-Rest-api/';

      var disqus_title = "iOS-app-with-Rest-api";


      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      
        run_disqus_script('embed.js');
      

    </script>
  





  
  

  

  

  
  


</body>
</html>
