<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="D3Af5_wNyfCxpGOmu04o8yJ6Y4au_48rBuja2NxHLOs" />










  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="Cowboy Tech" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Cowboy Tech">
<meta property="og:url" content="http://jackliu17.github.io/index.html">
<meta property="og:site_name" content="Cowboy Tech">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cowboy Tech">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Cowboy Tech </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Cowboy Tech</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">The best preparation for tomorrow is doing your best today</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      


      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/07/Technical-issue/" itemprop="url">
                  Technical_issue
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-07T18:11:47+11:00" content="2016-10-07">
              2016-10-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/IT/" itemprop="url" rel="index">
                    <span itemprop="name">IT</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/07/Technical-issue/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/10/07/Technical-issue/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="EasyCat-iOS"><a href="#EasyCat-iOS" class="headerlink" title="EasyCat iOS"></a>EasyCat iOS</h1><h2 id="Issue-071016"><a href="#Issue-071016" class="headerlink" title="Issue 071016"></a>Issue 071016</h2><p>在验证archive准备上传到app store的时候，屡次出现”No matching provisioning file for ……”</p>
<h2 id="Solution-071016"><a href="#Solution-071016" class="headerlink" title="Solution 071016"></a>Solution 071016</h2><ol>
<li>删除keychain和developer account里所有过期的证书</li>
<li>Xcode - preference - account 重新下载provisioning file</li>
<li>最后发现是实际的bundle id 和team provisioning file里的不一致，如图</li>
<li>最后在bundle id的空格里重新填写一遍，然后team provisioning file里的就和实际一致了，这应该是xcode 8的bug.</li>
</ol>
<p><img src="https://www.dropbox.com/s/sciwlcnc0pjkal8/2016100701.png?dl=1" alt=""></p>
<h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><ol>
<li>怎么创建和修改team provisioning profile?</li>
<li>为什么xcode managed profile中生成的是team provisioning profile?</li>
<li>App ID 为什么是 *</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/07/App-Distribution-Guide/" itemprop="url">
                  App_Distribution_Guide
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-07T18:05:27+11:00" content="2016-10-07">
              2016-10-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/IT/" itemprop="url" rel="index">
                    <span itemprop="name">IT</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/07/App-Distribution-Guide/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/10/07/App-Distribution-Guide/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Maintaining-Your-Signing-Identities-and-Certificates"><a href="#Maintaining-Your-Signing-Identities-and-Certificates" class="headerlink" title="Maintaining Your Signing Identities and Certificates"></a>Maintaining Your Signing Identities and Certificates</h1><h2 id="About-Signing-Identities-and-Certificates"><a href="#About-Signing-Identities-and-Certificates" class="headerlink" title="About Signing Identities and Certificates"></a>About Signing Identities and Certificates</h2><p>Code signing your app lets users trust that your app has been created by a source known to Apple and that it hasn’t been tampered with.</p>
<p>signing identities—stored in your keychain</p>
<p>certificates—stored in your developer account</p>
<p><img src="https://www.dropbox.com/s/l6jzxk1z8pvsumz/2016100610.png?dl=1" alt=""></p>
<h2 id="Viewing-Signing-Identities-and-Provisioning-Profiles"><a href="#Viewing-Signing-Identities-and-Provisioning-Profiles" class="headerlink" title="Viewing Signing Identities and Provisioning Profiles"></a>Viewing Signing Identities and Provisioning Profiles</h2><p>To view account details</p>
<ol>
<li>Choose Xcode &gt; Preferences.</li>
<li>Click Accounts at the top of the window.</li>
<li>Select the team you want to view, and click View Details.</li>
</ol>
<p>If a Create button appears next to a certificate, it hasn’t been created yet. If a Download button appears next to a provisioning profile, it’s not on your Mac.</p>
<p><img src="https://www.dropbox.com/s/twrmwfcv0i6famb/2016100607.png?dl=1" alt=""></p>
<h2 id="Creating-Signing-Identities"><a href="#Creating-Signing-Identities" class="headerlink" title="Creating Signing Identities"></a>Creating Signing Identities</h2><p>In the dialog that appears, click the Create button in the row of the type of certificate you want to create.<br>If the Create button is disabled, you are not allowed to create that type of signing identity.</p>
<p><img src="https://www.dropbox.com/s/up6kuyun7rk1ers/2016100608.png?dl=1" alt=""></p>
<h2 id="Verifying-Your-Steps"><a href="#Verifying-Your-Steps" class="headerlink" title="Verifying Your Steps"></a>Verifying Your Steps</h2><h3 id="Verifying-Using-Your-Developer-Account"><a href="#Verifying-Using-Your-Developer-Account" class="headerlink" title="Verifying Using Your Developer Account"></a>Verifying Using Your Developer Account</h3><ol>
<li>Sign in to developer.apple.com/account, and click Certificates, IDs &amp; Profiles.</li>
<li>In the Certificates section of the sidebar, select Development or Production depending on the type of certificate you want to verify.</li>
<li>The type and expiration date of the certificate should <strong>match</strong> the information that you view in Keychain Access.</li>
</ol>
<p><img src="https://www.dropbox.com/s/aaxupfrzc7vu1ul/2016100609.png?dl=1" alt=""></p>
<h2 id="Verifying-Using-Keychain-Access"><a href="#Verifying-Using-Keychain-Access" class="headerlink" title="Verifying Using Keychain Access"></a>Verifying Using Keychain Access</h2><p>When you create a development or distribution certificate using Xcode, the certificate is automatically installed in your login keychain.</p>
<p>In the left pane, select “login” in the Keychains section and select Certificates in the Category section.</p>
<p>The name of the development certificate begins with the text “iPhone Developer”</p>
<p><img src="https://www.dropbox.com/s/bzk1l349jkq8n0f/2016100611.png?dl=1" alt="11"></p>
<p>If you click the disclosure triangle next to the certificate name, your private key appears. If the disclosure triangle doesn’t appear, you’re missing your private key</p>
<p><img src="https://www.dropbox.com/s/7opgx7g6jy022a4/2016100612.png?dl=1" alt="12"></p>
<h2 id="Installing-Missing-Intermediate-Certificate-Authorities"><a href="#Installing-Missing-Intermediate-Certificate-Authorities" class="headerlink" title="Installing Missing Intermediate Certificate Authorities"></a>Installing Missing Intermediate Certificate Authorities</h2><p>To use your certificates, the correct intermediate certificate needs to be in your keychain.</p>
<p>An intermediate certificate ensures that your certificates were issued by a trusted source. </p>
<p>The intermediate certificate, named Apple Worldwide Developer Relations Certification Authority, is installed in your system keychain when you install Xcode. </p>
<p>First try downloading your provisioning profiles in Xcode to install missing intermediate certificates. If that doesn’t work for you, download and install the missing intermediate certificate.</p>
<ol>
<li>Go to <a href="http://www.apple.com/certificateauthority" target="_blank" rel="external">http://www.apple.com/certificateauthority</a>.</li>
<li>Under Apple Intermediate Certificates, click the link for the intermediate certificate you’re missing.A certificate file, with a .cer extension, appears in your Downloads folder.</li>
<li>Double-click the certificate file to install it in your system keychain.</li>
</ol>
<p><img src="https://www.dropbox.com/s/xq7ckol8gf1htdb/2016100613.png?dl=1" alt="13"></p>
<h2 id="Exporting-and-Importing-Certificates-and-Profiles"><a href="#Exporting-and-Importing-Certificates-and-Profiles" class="headerlink" title="Exporting and Importing Certificates and Profiles"></a>Exporting and Importing Certificates and Profiles</h2><p>After Xcode creates your certificates and profiles for you, export them to create a backup of all your assets. You do this to, for example, transfer your assets to another Mac you use for development or repair a certificate if the private key is missing.</p>
<p>The export file, called a <strong>developer profile</strong>, contains the following team assets:</p>
<ul>
<li>Development certificates</li>
<li>Distribution certificates</li>
<li>Provisioning profiles</li>
</ul>
<p><img src="https://www.dropbox.com/s/7u4hzq7xcrmpten/2016100617.png?dl=1" alt="17"></p>
<p><img src="https://www.dropbox.com/s/y1vhmdjk23puiph/2016100618.png?dl=1" alt="18"></p>
<h3 id="Exporting-Selected-Certificates"><a href="#Exporting-Selected-Certificates" class="headerlink" title="Exporting Selected Certificates"></a>Exporting Selected Certificates</h3><p><img src="https://www.dropbox.com/s/ikzdvukezaaco69/2016100619.png?dl=1" alt="19"></p>
<h3 id="Importing-Your-Developer-Profile"><a href="#Importing-Your-Developer-Profile" class="headerlink" title="Importing Your Developer Profile"></a>Importing Your Developer Profile</h3><p>You import your developer profile to restore missing private keys or when you want to switch to another Mac.</p>
<p><img src="https://www.dropbox.com/s/5eb2uz6e0mbenhz/2016100620.png?dl=1" alt="20"></p>
<h2 id="Removing-Signing-Identities-from-Your-Keychain"><a href="#Removing-Signing-Identities-from-Your-Keychain" class="headerlink" title="Removing Signing Identities from Your Keychain"></a>Removing Signing Identities from Your Keychain</h2><p>Delete in key category first , then delete them in My certificate category</p>
<p><img src="https://www.dropbox.com/s/nwjjl9lf3ky3p1k/2016100621.png?dl=1" alt="21"></p>
<h2 id="Revoking-Certificates"><a href="#Revoking-Certificates" class="headerlink" title="Revoking Certificates"></a>Revoking Certificates</h2><p>If you’re a team admin for an organization, you may want to revoke development certificates of team members who no longer work on your project. </p>
<p>Revoking certificates may invalidate provisioning profiles,</p>
<p>Revoking development or distribution certificates doesn’t affect apps that you’ve submitted to the store nor does it affect your ability to update them</p>
<h3 id="Resetting-Certificates-Using-Xcode"><a href="#Resetting-Certificates-Using-Xcode" class="headerlink" title="Resetting Certificates Using Xcode"></a>Resetting Certificates Using Xcode</h3><p>If Xcode displays a Create button, the signing identity doesn’t exist in your developer account or on your Mac. </p>
<p>If Xcode displays a Reset button, the signing identity is not usable on your Mac—for example, it is missing the private key. </p>
<p>If you click the Reset button, Xcode revokes and re-creates the corresponding certificate.</p>
<p><img src="https://www.dropbox.com/s/gktgv656zbp8mhi/2016100622.png?dl=1" alt="22"></p>
<h3 id="Revoking-Certificates-Using-the-Developer-Account"><a href="#Revoking-Certificates-Using-the-Developer-Account" class="headerlink" title="Revoking Certificates Using the Developer Account"></a>Revoking Certificates Using the Developer Account</h3><p><img src="https://www.dropbox.com/s/gvpk6c1lcioi5ad/2016100623.png?dl=1" alt="23"></p>
<h2 id="Re-Creating-Certificates-and-Updating-Related-Provisioning-Profiles"><a href="#Re-Creating-Certificates-and-Updating-Related-Provisioning-Profiles" class="headerlink" title="Re-Creating Certificates and Updating Related Provisioning Profiles"></a>Re-Creating Certificates and Updating Related Provisioning Profiles</h2><p>Revoke the certificates using your developer account</p>
<p>Provisioning profiles containing a revoked certificate become invalid.</p>
<p>If necessary, remove the signing identities for these certificates from your keychain</p>
<p>Remove or regenerate other types of provisioning profiles that contain the revoked certificates,</p>
<p><img src="https://www.dropbox.com/s/27mdb06bipepa9j/2016100624.png?dl=1" alt="24"></p>
<h1 id="Maintaining-Identifiers-Devices-and-Profiles"><a href="#Maintaining-Identifiers-Devices-and-Profiles" class="headerlink" title="Maintaining Identifiers, Devices, and Profiles"></a>Maintaining Identifiers, Devices, and Profiles</h1><h2 id="App-IDs-Registering-Editing-Deleting"><a href="#App-IDs-Registering-Editing-Deleting" class="headerlink" title="App IDs-Registering/Editing/Deleting"></a>App IDs-Registering/Editing/Deleting</h2><p><img src="https://www.dropbox.com/s/yzlzplj6if2gm51/2016100614.png?dl=1" alt="14"></p>
<h2 id="Locating-Your-Team-ID"><a href="#Locating-Your-Team-ID" class="headerlink" title="Locating Your Team ID"></a>Locating Your Team ID</h2><p>Sign in to developer.apple.com/account, and click Membership in the sidebar.Your Team ID appears in the Membership Information section under the team name.</p>
<h2 id="Provisioning-profiles"><a href="#Provisioning-profiles" class="headerlink" title="Provisioning profiles"></a>Provisioning profiles</h2><p><strong>A provisioning profile includes signing certificates, device identifiers, and an App ID.</strong> </p>
<p>Development provisioning profiles are used to build and install versions of your app during the development cycle, </p>
<p>Distribution provisioning profiles are used to submit your apps to the App Store and distribute them to beta testers.</p>
<h3 id="Generate-Provisioning-Profiles-with-Xcode"><a href="#Generate-Provisioning-Profiles-with-Xcode" class="headerlink" title="Generate Provisioning Profiles with Xcode"></a>Generate Provisioning Profiles with Xcode</h3><ol>
<li>Connect your device to your Mac and click Use for Development in Xcode’s Organizer window. </li>
<li>Sign in with the Apple ID associated with your iOS Developer Program membership and Xcode will generate a provisioning profile containing your certificate and device identifier.</li>
</ol>
<h3 id="Creating-Provisioning-Profiles-Using-Your-Developer-Account-略"><a href="#Creating-Provisioning-Profiles-Using-Your-Developer-Account-略" class="headerlink" title="Creating Provisioning Profiles Using Your Developer Account (略)"></a>Creating Provisioning Profiles Using Your Developer Account (略)</h3><h3 id="Downloading-Provisioning-Profiles-in-Xcode"><a href="#Downloading-Provisioning-Profiles-in-Xcode" class="headerlink" title="Downloading Provisioning Profiles in Xcode"></a>Downloading Provisioning Profiles in Xcode</h3><ol>
<li>In the Xcode Preferences window, click Accounts.</li>
<li>Select your team, and click View Details.</li>
<li>In the dialog that appears, click the “Download all” button in the lower-left corner under the Provisioning Profiles table.</li>
</ol>
<p><img src="https://www.dropbox.com/s/hln1s0d0s13k5f4/2016100615.png?dl=1" alt="15"></p>
<h3 id="Editing-Provisioning-Profiles-in-Your-Developer-Account"><a href="#Editing-Provisioning-Profiles-in-Your-Developer-Account" class="headerlink" title="Editing Provisioning Profiles in Your Developer Account"></a>Editing Provisioning Profiles in Your Developer Account</h3><p>After doing so, download provisioning profiles in Xcode</p>
<p><img src="https://www.dropbox.com/s/i6fgdjgfrqlgp8y/2016100616.png?dl=1" alt="16"></p>
<h3 id="Renewing-Expired-Provisioning-Profiles"><a href="#Renewing-Expired-Provisioning-Profiles" class="headerlink" title="Renewing Expired Provisioning Profiles"></a>Renewing Expired Provisioning Profiles</h3><p>You don’t need to make any changes to the provisioning profile. Just scroll to the bottom of the Edit iOS Provisioning Profile or the Edit Mac Provisioning Profile page, and click Generate</p>
<h1 id="Configuring-Your-Xcode-Project-for-Distribution"><a href="#Configuring-Your-Xcode-Project-for-Distribution" class="headerlink" title="Configuring Your Xcode Project for Distribution"></a>Configuring Your Xcode Project for Distribution</h1><h2 id="Configuring-Identity-and-Team-Settings"><a href="#Configuring-Identity-and-Team-Settings" class="headerlink" title="Configuring Identity and Team Settings"></a>Configuring Identity and Team Settings</h2><h3 id="About-Bundle-IDs"><a href="#About-Bundle-IDs" class="headerlink" title="About Bundle IDs"></a>About Bundle IDs</h3><p>A bundle ID precisely identifies a single app</p>
<p>reverse-DNS format. com.Acme.Hello </p>
<p>use an app’s bundle ID in many different places to identify the app</p>
<p><img src="https://www.dropbox.com/s/ykiv7fvs9p7i199/2016100605.png?dl=1" alt=""></p>
<h3 id="App-ID"><a href="#App-ID" class="headerlink" title="App ID"></a>App ID</h3><p>app’s bundle ID needs to be unique. </p>
<p>The string consists of a Team ID and a bundle ID search string</p>
<p><img src="https://www.dropbox.com/s/pnhwknamzfpy722/2016100606.png?dl=1" alt=""></p>
<p>There are two types of App IDs:</p>
<p>An Explicit App ID Matches a Single App</p>
<p>Wildcard App IDs Match Multiple Apps</p>
<h3 id="Setting-the-Bundle-ID"><a href="#Setting-the-Bundle-ID" class="headerlink" title="Setting the Bundle ID"></a>Setting the Bundle ID</h3><p><img src="https://www.dropbox.com/s/351v6om3lounzht/2016100602.png?dl=1" alt=""></p>
<p><img src="https://www.dropbox.com/s/6img87h9jdfss6h/2016100603.png?dl=1" alt=""></p>
<h3 id="Assigning-the-Xcode-Project-to-a-Team"><a href="#Assigning-the-Xcode-Project-to-a-Team" class="headerlink" title="Assigning the Xcode Project to a Team"></a>Assigning the Xcode Project to a Team</h3><p><img src="https://www.dropbox.com/s/974hoa80mz1zr9q/2016100604.png?dl=1" alt="5"></p>
<h2 id="Creating-the-Team-Provisioning-Profile"><a href="#Creating-the-Team-Provisioning-Profile" class="headerlink" title="Creating the Team Provisioning Profile"></a>Creating the Team Provisioning Profile</h2><p>After you select a team, <strong>Xcode attempts to create a specialized development provisioning profile</strong> called a team provisioning profile that it manages for you. </p>
<p>A team provisioning profile allows an app to be signed and run by all team members on all their devices.</p>
<h2 id="Setting-the-Version-Number-and-Build-String"><a href="#Setting-the-Version-Number-and-Build-String" class="headerlink" title="Setting the Version Number and Build String"></a>Setting the Version Number and Build String</h2><p>The version number is a two-period-separated list of positive integers, as in 4.5.2. </p>
<p>The first integer represents a major revision, the second a minor revision, and the third a maintenance release. </p>
<p>The version number is shown in the store</p>
<p>The build string represents an iteration (released or unreleased) of the bundle and is also a two-period-separated list of positive integers, as in 1.2.3. </p>
<h2 id="Setting-Deployment-Info"><a href="#Setting-Deployment-Info" class="headerlink" title="Setting Deployment Info"></a>Setting Deployment Info</h2><p>The deployment target setting specifies the lowest operating system version that your app can run on.</p>
<p><img src="https://www.dropbox.com/s/2zep1n66rshzfgz/2016100601.png?dl=1" alt=""></p>
<h2 id="Adding-App-Icons-and-a-Launch-Screen-File-略"><a href="#Adding-App-Icons-and-a-Launch-Screen-File-略" class="headerlink" title="Adding App Icons and a Launch Screen File (略)"></a>Adding App Icons and a Launch Screen File (略)</h2>
          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/04/GCD学习笔记/" itemprop="url">
                  GCD学习笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-04T08:57:43+11:00" content="2016-10-04">
              2016-10-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/IT/" itemprop="url" rel="index">
                    <span itemprop="name">IT</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/04/GCD学习笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/10/04/GCD学习笔记/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="多线程基础"><a href="#多线程基础" class="headerlink" title="多线程基础"></a>多线程基础</h1><h2 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h2><p>进程是指在系统中正在运行的一个应用程序</p>
<p>每个进程之间是独立的，每个进程均运行在其专用且受保护的内存空间内</p>
<h2 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h2><p>1个进程要想执行任务，必须得有线程（每1个进程至少要有1条线程，称为主线程）</p>
<p>一个进程（程序）的所有任务都在线程中执行</p>
<h2 id="进程和线程的比较"><a href="#进程和线程的比较" class="headerlink" title="进程和线程的比较"></a>进程和线程的比较</h2><ol>
<li><p>线程是CPU调用(执行任务)的最小单位。</p>
</li>
<li><p>进程是CPU分配资源的最小单位。</p>
</li>
<li><p>一个进程中至少要有一个线程。</p>
</li>
<li><p>同一个进程内的线程共享进程的资源。</p>
</li>
</ol>
<h2 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h2><p>1个进程中可以开启多条线程，每条线程可以并行（同时）执行不同的任务</p>
<p>多线程技术可以提高程序的执行效率</p>
<p>同一时间，CPU只能处理1条线程，只有1条线程在工作（执行），多线程并发（同时）执行，其实是CPU快速地在多条线程之间调度（切换），如果CPU调度线程的时间足够快，就造成了多线程并发执行的假象。</p>
<h1 id="GCD"><a href="#GCD" class="headerlink" title="GCD"></a>GCD</h1><h2 id="任务执行方式"><a href="#任务执行方式" class="headerlink" title="任务执行方式"></a>任务执行方式</h2><h3 id="同步执行："><a href="#同步执行：" class="headerlink" title="同步执行："></a>同步执行：</h3><p>只能在当前线程中执行任务，不具备开启新线程的能力，任务立刻马上执行，会阻塞当前线程并等待 Block中的任务执行完毕，然后当前线程才会继续往下运行</p>
<h3 id="异步执行："><a href="#异步执行：" class="headerlink" title="异步执行："></a>异步执行：</h3><p>可以在新的线程中执行任务，具备开启新线程的能力，但不一定会开新线程，当前线程会直接往下执行，不会阻塞当前线程</p>
<h2 id="队列："><a href="#队列：" class="headerlink" title="队列："></a>队列：</h2><p>即用来存放任务的队列。队列是一种特殊的线性表，采用FIFO（先进先出）的原则，即新任务总是被插入到队列的末尾，而读取任务的时候总是从队列的头部开始读取。每读取一个任务，则从队列中释放一个任务。在GCD中有两种队列：串行队列和并发队列。</p>
<h3 id="串行队列（Serial-Dispatch-Queue）"><a href="#串行队列（Serial-Dispatch-Queue）" class="headerlink" title="串行队列（Serial Dispatch Queue）"></a>串行队列（Serial Dispatch Queue）</h3><p>让任务一个接着一个地执行（一个任务执行完毕后，再执行下一个任务）</p>
<h3 id="并发队列（Concurrent-Dispatch-Queue）"><a href="#并发队列（Concurrent-Dispatch-Queue）" class="headerlink" title="并发队列（Concurrent Dispatch Queue）"></a>并发队列（Concurrent Dispatch Queue）</h3><p>可以让多个任务并发（同时）执行（自动开启多个线程同时执行任务）,并发功能只有在异步（dispatch_async）函数下才有效</p>
<h2 id="GCD的使用"><a href="#GCD的使用" class="headerlink" title="GCD的使用"></a>GCD的使用</h2><h3 id="队列的创建"><a href="#队列的创建" class="headerlink" title="队列的创建"></a>队列的创建</h3><p>创建并发队列</p>
<pre><code>dispatch_queue_t queue = dispatch_queue_create(&quot;com.xxcc&quot;, DISPATCH_QUEUE_CONCURRENT);
</code></pre><p>GCD默认已经提供了全局并发队列</p>
<pre><code>dispatch_queue_t quque1 =  dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
</code></pre><p>创建串行队列</p>
<pre><code>dispatch_queue_t queue = dispatch_queue_create(&quot;com.xxcc&quot;, DISPATCH_QUEUE_SERIAL);
</code></pre><p>获得主队列</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_t  queue = dispatch_get_main_queue();</span><br></pre></td></tr></table></figure>
<h3 id="任务的执行"><a href="#任务的执行" class="headerlink" title="任务的执行"></a>任务的执行</h3><p>队列在queue中，任务在block块中</p>
<p>同步函数：要求立刻马上开始执行</p>
<pre><code>/*
第一个参数:队列
第二个参数:block,在里面封装任务
*/
dispatch_sync(queue, ^{

});
</code></pre><p>异步函数 ：等主线程执行完毕之后，回过头开线程执行任务</p>
<pre><code>dispatch_async(queue, ^{

});
</code></pre><h1 id="GCD的使用-1"><a href="#GCD的使用-1" class="headerlink" title="GCD的使用"></a>GCD的使用</h1><h2 id="六种组合使用"><a href="#六种组合使用" class="headerlink" title="六种组合使用"></a>六种组合使用</h2><ol>
<li><p>并发队列 + 同步执行: 无新线程，串行执行 </p>
</li>
<li><p>并发队列 + 异步执行：有新线程，并发执行</p>
</li>
<li><p>串行队列 + 同步执行: 无新线程，串行执行</p>
</li>
<li><p>串行队列 + 异步执行：有1条新线程，并发执行</p>
</li>
<li><p>主队列 + 同步执行: 无新线程，串行执行 </p>
</li>
<li><p>主队列 + 异步执行: 无新线程，串行执行 </p>
</li>
</ol>
<h2 id="并发队列-同步执行"><a href="#并发队列-同步执行" class="headerlink" title="并发队列 + 同步执行"></a>并发队列 + 同步执行</h2><ol>
<li><p>所有任务都是在主线程中执行的,不会开启新线程，由于只有一个线程，所以任务只能一个一个执行。</p>
</li>
<li><p>所有任务都在打印的syncConcurrent—begin和syncConcurrent—end之间，这说明任务是添加到队列中马上执行的。</p>
</li>
</ol>
<pre><code>- (void) syncConcurrent
{
    NSLog(@&quot;syncConcurrent---begin&quot;);

    dispatch_queue_t queue= dispatch_queue_create(&quot;test.queue&quot;, DISPATCH_QUEUE_CONCURRENT);

    dispatch_sync(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;1------%@&quot;,[NSThread currentThread]);
        }
    });
    dispatch_sync(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;2------%@&quot;,[NSThread currentThread]);
        }
    });
    dispatch_sync(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;3------%@&quot;,[NSThread currentThread]);
        }
    });

    NSLog(@&quot;syncConcurrent---end&quot;);
}

2016-10-04 12:28:52.933 FL_GCD_DEMO[6892:714486] syncConcurrent---begin
2016-10-04 12:28:52.933 FL_GCD_DEMO[6892:714486] 1------&lt;NSThread: 0x61800006d8c0&gt;{number = 1, name = main}
2016-10-04 12:28:52.934 FL_GCD_DEMO[6892:714486] 1------&lt;NSThread: 0x61800006d8c0&gt;{number = 1, name = main}
2016-10-04 12:28:52.934 FL_GCD_DEMO[6892:714486] 2------&lt;NSThread: 0x61800006d8c0&gt;{number = 1, name = main}
2016-10-04 12:28:52.934 FL_GCD_DEMO[6892:714486] 2------&lt;NSThread: 0x61800006d8c0&gt;{number = 1, name = main}
2016-10-04 12:28:52.934 FL_GCD_DEMO[6892:714486] 3------&lt;NSThread: 0x61800006d8c0&gt;{number = 1, name = main}
2016-10-04 12:28:52.934 FL_GCD_DEMO[6892:714486] 3------&lt;NSThread: 0x61800006d8c0&gt;{number = 1, name = main}
2016-10-04 12:28:52.935 FL_GCD_DEMO[6892:714486] syncConcurrent---end
</code></pre><h2 id="并发队列-异步执行"><a href="#并发队列-异步执行" class="headerlink" title="并发队列 + 异步执行"></a>并发队列 + 异步执行</h2><ol>
<li><p>除了主线程，又开启了3个线程，并且任务是交替着同时执行的。</p>
</li>
<li><p>所有任务是在打印的syncConcurrent—begin和syncConcurrent—end之后才开始执行的。说明任务不是马上执行，而是将所有任务添加到队列之后才开始同步执行。</p>
</li>
</ol>
<pre><code>- (void) asyncConcurrent
{
    NSLog(@&quot;asyncConcurrent---begin&quot;);

    dispatch_queue_t queue= dispatch_queue_create(&quot;test.queue&quot;, DISPATCH_QUEUE_CONCURRENT);

    dispatch_async(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;1------%@&quot;,[NSThread currentThread]);
        }
    });
    dispatch_async(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;2------%@&quot;,[NSThread currentThread]);
        }
    });
    dispatch_async(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;3------%@&quot;,[NSThread currentThread]);
        }
    });

    NSLog(@&quot;asyncConcurrent---end&quot;);
}

2016-10-04 12:41:45.567 FL_GCD_DEMO[7091:747862] asyncConcurrent---begin
2016-10-04 12:41:45.568 FL_GCD_DEMO[7091:747862] asyncConcurrent---end
2016-10-04 12:41:45.568 FL_GCD_DEMO[7091:747987] 1------&lt;NSThread: 0x610000071900&gt;{number = 3, name = (null)}
2016-10-04 12:41:45.568 FL_GCD_DEMO[7091:747986] 2------&lt;NSThread: 0x60000006f380&gt;{number = 4, name = (null)}
2016-10-04 12:41:45.568 FL_GCD_DEMO[7091:747989] 3------&lt;NSThread: 0x60800006f800&gt;{number = 5, name = (null)}
2016-10-04 12:41:45.568 FL_GCD_DEMO[7091:747987] 1------&lt;NSThread: 0x610000071900&gt;{number = 3, name = (null)}
2016-10-04 12:41:45.568 FL_GCD_DEMO[7091:747986] 2------&lt;NSThread: 0x60000006f380&gt;{number = 4, name = (null)}
2016-10-04 12:41:45.568 FL_GCD_DEMO[7091:747989] 3------&lt;NSThread: 0x60800006f800&gt;{number = 5, name = (null)}
</code></pre><h2 id="串行队列-同步执行"><a href="#串行队列-同步执行" class="headerlink" title="串行队列 + 同步执行"></a>串行队列 + 同步执行</h2><ol>
<li><p>不会开启新线程，在当前线程执行任务。任务是串行的，执行完一个任务，再执行下一个任务</p>
</li>
<li><p>所有任务是在打印的syncConcurrent—begin和syncConcurrent—end之后才开始执行的。说明任务不是马上执行，而是将所有任务添加到队列之后才开始同步执行。</p>
</li>
</ol>
<pre><code>- (void) syncSerial
{
    NSLog(@&quot;syncSerial---begin&quot;);

    dispatch_queue_t queue = dispatch_queue_create(&quot;test.queue&quot;, DISPATCH_QUEUE_SERIAL);

    dispatch_sync(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;1------%@&quot;,[NSThread currentThread]);
        }
    });    
    dispatch_sync(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;2------%@&quot;,[NSThread currentThread]);
        }
    });
    dispatch_sync(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;3------%@&quot;,[NSThread currentThread]);
        }
    });

    NSLog(@&quot;syncSerial---end&quot;);
}

2016-10-04 12:46:10.354 FL_GCD_DEMO[7152:759077] syncSerial---begin
2016-10-04 12:46:10.355 FL_GCD_DEMO[7152:759077] 1------&lt;NSThread: 0x60800007b580&gt;{number = 1, name = main}
2016-10-04 12:46:10.355 FL_GCD_DEMO[7152:759077] 1------&lt;NSThread: 0x60800007b580&gt;{number = 1, name = main}
2016-10-04 12:46:10.355 FL_GCD_DEMO[7152:759077] 2------&lt;NSThread: 0x60800007b580&gt;{number = 1, name = main}
2016-10-04 12:46:10.355 FL_GCD_DEMO[7152:759077] 2------&lt;NSThread: 0x60800007b580&gt;{number = 1, name = main}
2016-10-04 12:46:10.355 FL_GCD_DEMO[7152:759077] 3------&lt;NSThread: 0x60800007b580&gt;{number = 1, name = main}
2016-10-04 12:46:10.356 FL_GCD_DEMO[7152:759077] 3------&lt;NSThread: 0x60800007b580&gt;{number = 1, name = main}
2016-10-04 12:46:10.356 FL_GCD_DEMO[7152:759077] syncSerial---end
</code></pre><h2 id="串行队列-异步执行"><a href="#串行队列-异步执行" class="headerlink" title="串行队列 + 异步执行"></a>串行队列 + 异步执行</h2><ol>
<li><p>会开启新线程，但是因为任务是串行的，执行完一个任务，再执行下一个任务</p>
</li>
<li><p>所有任务是在打印的syncConcurrent—begin和syncConcurrent—end之后才开始执行的。说明任务不是马上执行，而是将所有任务添加到队列之后才开始同步执行。</p>
</li>
</ol>
<pre><code>- (void) asyncSerial
{
    NSLog(@&quot;asyncSerial---begin&quot;);

    dispatch_queue_t queue = dispatch_queue_create(&quot;test.queue&quot;, DISPATCH_QUEUE_SERIAL);

    dispatch_async(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;1------%@&quot;,[NSThread currentThread]);
        }
    });    
    dispatch_async(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;2------%@&quot;,[NSThread currentThread]);
        }
    });
    dispatch_async(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;3------%@&quot;,[NSThread currentThread]);
        }
    });

    NSLog(@&quot;asyncSerial---end&quot;);
}

2016-10-04 15:22:49.819 FL_GCD_DEMO[8557:1007533] asyncSerial---begin
2016-10-04 15:22:49.819 FL_GCD_DEMO[8557:1007533] asyncSerial---end
2016-10-04 15:22:49.819 FL_GCD_DEMO[8557:1007620] 1------&lt;NSThread: 0x610000068940&gt;{number = 3, name = (null)}
2016-10-04 15:22:49.820 FL_GCD_DEMO[8557:1007620] 1------&lt;NSThread: 0x610000068940&gt;{number = 3, name = (null)}
2016-10-04 15:22:49.820 FL_GCD_DEMO[8557:1007620] 2------&lt;NSThread: 0x610000068940&gt;{number = 3, name = (null)}
2016-10-04 15:22:49.820 FL_GCD_DEMO[8557:1007620] 2------&lt;NSThread: 0x610000068940&gt;{number = 3, name = (null)}
2016-10-04 15:22:49.820 FL_GCD_DEMO[8557:1007620] 3------&lt;NSThread: 0x610000068940&gt;{number = 3, name = (null)}
2016-10-04 15:22:49.820 FL_GCD_DEMO[8557:1007620] 3------&lt;NSThread: 0x610000068940&gt;{number = 3, name = (null)}
</code></pre><h2 id="主队列-同步执行"><a href="#主队列-同步执行" class="headerlink" title="主队列 + 同步执行"></a>主队列 + 同步执行</h2><pre><code>- (void)syncMain
{
    NSLog(@&quot;syncMain---begin&quot;);

    dispatch_queue_t queue = dispatch_get_main_queue();

    dispatch_sync(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;1------%@&quot;,[NSThread currentThread]);
        }
    });
    dispatch_sync(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;2------%@&quot;,[NSThread currentThread]);
        }
    });
    dispatch_sync(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;3------%@&quot;,[NSThread currentThread]);
        }
    });   

    NSLog(@&quot;syncMain---end&quot;);
}
</code></pre><p>互等卡住不可行(在主线程中调用),dispatch_sync需要立即执行，而现在正在执行syncMain,除非将syncMain放到其他线程</p>
<pre><code>dispatch_queue_t queue = dispatch_queue_create(&quot;test.queue&quot;, DISPATCH_QUEUE_CONCURRENT);

dispatch_async(queue, ^{
    [self syncMain];
});
</code></pre><h2 id="主队列-异步执行"><a href="#主队列-异步执行" class="headerlink" title="主队列 + 异步执行"></a>主队列 + 异步执行</h2><pre><code>- (void)asyncMain
{
    NSLog(@&quot;asyncMain---begin&quot;);

    dispatch_queue_t queue = dispatch_get_main_queue();

    dispatch_async(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;1------%@&quot;,[NSThread currentThread]);
        }
    });    
    dispatch_async(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;2------%@&quot;,[NSThread currentThread]);
        }
    });
    dispatch_async(queue, ^{
        for (int i = 0; i &lt; 2; ++i) {
            NSLog(@&quot;3------%@&quot;,[NSThread currentThread]);
        }
    });  

    NSLog(@&quot;asyncMain---end&quot;);
}

2016-10-04 16:09:35.551 FL_GCD_DEMO[9244:1128884] 1------&lt;NSThread: 0x618000078700&gt;{number = 1, name = main}
2016-10-04 16:09:35.551 FL_GCD_DEMO[9244:1128884] 1------&lt;NSThread: 0x618000078700&gt;{number = 1, name = main}
2016-10-04 16:09:35.552 FL_GCD_DEMO[9244:1128884] 2------&lt;NSThread: 0x618000078700&gt;{number = 1, name = main}
2016-10-04 16:09:35.552 FL_GCD_DEMO[9244:1128884] 2------&lt;NSThread: 0x618000078700&gt;{number = 1, name = main}
2016-10-04 16:09:35.552 FL_GCD_DEMO[9244:1128884] 3------&lt;NSThread: 0x618000078700&gt;{number = 1, name = main}
2016-10-04 16:09:35.552 FL_GCD_DEMO[9244:1128884] 3------&lt;NSThread: 0x618000078700&gt;{number = 1, name = main}
</code></pre><h2 id="其他线程中返回到主线程"><a href="#其他线程中返回到主线程" class="headerlink" title="其他线程中返回到主线程"></a>其他线程中返回到主线程</h2><pre><code>dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    for (int i = 0; i &lt; 2; ++i) {
        NSLog(@&quot;1------%@&quot;,[NSThread currentThread]);
    }

    // 回到主线程
    dispatch_async(dispatch_get_main_queue(), ^{
        NSLog(@&quot;2-------%@&quot;,[NSThread currentThread]);
    });
});
</code></pre><h2 id="栅栏方法-dispatch-barrier-async"><a href="#栅栏方法-dispatch-barrier-async" class="headerlink" title="栅栏方法 dispatch_barrier_async"></a>栅栏方法 dispatch_barrier_async</h2><p>异步执行两组操作，而且第一组操作执行完之后，才能开始执行第二组操作。这样我们就需要一个相当于栅栏一样的一个方法将两组异步执行的操作组给分割起来，当然这里的操作组里可以包含一个或多个任务。这就需要用到dispatch_barrier_async方法在两个操作组间形成栅栏。</p>
<pre><code>- (void)barrier
{
    dispatch_queue_t queue = dispatch_queue_create(&quot;12312312&quot;, DISPATCH_QUEUE_CONCURRENT);

    dispatch_async(queue, ^{
        NSLog(@&quot;----1-----%@&quot;, [NSThread currentThread]);
    });
    dispatch_async(queue, ^{
        NSLog(@&quot;----2-----%@&quot;, [NSThread currentThread]);
    });

    dispatch_barrier_async(queue, ^{
        NSLog(@&quot;----barrier-----%@&quot;, [NSThread currentThread]);
    });

    dispatch_async(queue, ^{
        NSLog(@&quot;----3-----%@&quot;, [NSThread currentThread]);
    });
    dispatch_async(queue, ^{
        NSLog(@&quot;----4-----%@&quot;, [NSThread currentThread]);
    });
}

2016-10-04 16:23:38.931 FL_GCD_DEMO[9572:1168918] ----1-----&lt;NSThread: 0x60000006e280&gt;{number = 3, name = (null)}
2016-10-04 16:23:38.931 FL_GCD_DEMO[9572:1168921] ----2-----&lt;NSThread: 0x60000006e240&gt;{number = 4, name = (null)}
2016-10-04 16:23:38.932 FL_GCD_DEMO[9572:1168921] ----barrier-----&lt;NSThread: 0x60000006e240&gt;{number = 4, name = (null)}
2016-10-04 16:23:38.932 FL_GCD_DEMO[9572:1168921] ----3-----&lt;NSThread: 0x60000006e240&gt;{number = 4, name = (null)}
2016-10-04 16:23:38.932 FL_GCD_DEMO[9572:1168918] ----4-----&lt;NSThread: 0x60000006e280&gt;{number = 3, name = (null)}
</code></pre><h2 id="延时执行方法-dispatch-after"><a href="#延时执行方法-dispatch-after" class="headerlink" title="延时执行方法 dispatch_after"></a>延时执行方法 dispatch_after</h2><pre><code>dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(2.0 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
    // 2秒后异步执行这里的代码...
NSLog(@&quot;run-----&quot;);
});
</code></pre><h2 id="一次性代码-dispatch-once"><a href="#一次性代码-dispatch-once" class="headerlink" title="一次性代码 dispatch_once"></a>一次性代码 dispatch_once</h2><p>使用dispatch_once函数能保证某段代码在程序运行过程中只被执行1次。</p>
<pre><code>static dispatch_once_t onceToken;
dispatch_once(&amp;onceToken, ^{
    // 只执行1次的代码(这里面默认是线程安全的)
});
</code></pre><h2 id="多线程同时遍历-dispatch-apply"><a href="#多线程同时遍历-dispatch-apply" class="headerlink" title="多线程同时遍历 dispatch_apply"></a>多线程同时遍历 dispatch_apply</h2><pre><code>dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);

dispatch_apply(6, queue, ^(size_t index) {
    NSLog(@&quot;%zd------%@&quot;,index, [NSThread currentThread]);
});

2016-10-04 16:30:58.280 FL_GCD_DEMO[9720:1191743] 1------&lt;NSThread: 0x610000067840&gt;{number = 3, name = (null)}
2016-10-04 16:30:58.280 FL_GCD_DEMO[9720:1191746] 3------&lt;NSThread: 0x610000067800&gt;{number = 5, name = (null)}
2016-10-04 16:30:58.280 FL_GCD_DEMO[9720:1191744] 2------&lt;NSThread: 0x60000006a200&gt;{number = 4, name = (null)}
2016-10-04 16:30:58.280 FL_GCD_DEMO[9720:1191661] 0------&lt;NSThread: 0x610000060e80&gt;{number = 1, name = main}
2016-10-04 16:30:58.280 FL_GCD_DEMO[9720:1191762] 4------&lt;NSThread: 0x610000067880&gt;{number = 6, name = (null)}
2016-10-04 16:30:58.280 FL_GCD_DEMO[9720:1191763] 5------&lt;NSThread: 0x610000067b00&gt;{number = 7, name = (null)}
</code></pre><h2 id="队列组-dispatch-group"><a href="#队列组-dispatch-group" class="headerlink" title="队列组 dispatch_group"></a>队列组 dispatch_group</h2><p>分别异步执行2个耗时操作，然后当2个耗时操作都执行完毕后再回到主线程执行操作。</p>
<pre><code>-(void)testGroupQueue
{
        NSLog(@&quot;用户想要登录&quot;);

        dispatch_group_t group = dispatch_group_create();

        dispatch_group_async(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{
            sleep(1);
            NSLog(@&quot;填写账号完成&quot;);
        });
        dispatch_group_async(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{
            sleep(1);
            NSLog(@&quot;填写密码完成&quot;);
        });

        dispatch_group_notify(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{
            NSLog(@&quot;用户可以登录了&quot;);
        });
}

2016-02-26 13:22:09.973 FL_GCD_DEMO[5494:3812823] 用户想要登录
2016-02-26 13:22:10.978 FL_GCD_DEMO[5494:3812859] 填写密码完成
2016-02-26 13:22:10.978 FL_GCD_DEMO[5494:3812860] 填写账号完成
2016-02-26 13:22:10.978 FL_GCD_DEMO[5494:3812860] 用户可以登录了
</code></pre><h1 id="Suspend和Resume"><a href="#Suspend和Resume" class="headerlink" title="Suspend和Resume"></a>Suspend和Resume</h1><p>有时可能需要我们中断某些操作，还需要我们恢复执行，这个时候就可以用到suspend和resume操作.</p>
<p>suspend不会停止当当前正在执行的block,而是中断了后面未执行的，在resume之后再执行后面的block</p>
<pre><code>-(void)testSuspendAndResume
{
    dispatch_queue_t queue = dispatch_queue_create(&quot;myqueue&quot;, DISPATCH_QUEUE_SERIAL);
    NSLog(@&quot;start&quot;);
    dispatch_async(queue, ^{
        [NSThread sleepForTimeInterval:5];
        NSLog(@&quot;1&quot;);
    });
    dispatch_async(queue, ^{
        [NSThread sleepForTimeInterval:5];
        NSLog(@&quot;2&quot;);
    });

    [NSThread sleepForTimeInterval:3];
    NSLog(@&quot;suspend&quot;);
    dispatch_suspend(queue);
    [NSThread sleepForTimeInterval:5];
    NSLog(@&quot;resume&quot;);
    dispatch_resume(queue);
}

2016-02-25 22:01:02.475 FL_GCD_DEMO[4890:3722720] start
2016-02-25 22:01:05.476 FL_GCD_DEMO[4890:3722720] suspend
2016-02-25 22:01:07.479 FL_GCD_DEMO[4890:3722759] 1
2016-02-25 22:01:10.478 FL_GCD_DEMO[4890:3722720] resume
2016-02-25 22:01:15.478 FL_GCD_DEMO[4890:3722759] 2
</code></pre><h1 id="dispatch-semaphore"><a href="#dispatch-semaphore" class="headerlink" title="dispatch_semaphore"></a>dispatch_semaphore</h1><pre><code>-(void)testSemaphore
{
    dispatch_semaphore_t semaphore = dispatch_semaphore_create(2);
    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
    for (int i = 0; i &lt;10; i++)
    {
        dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER);
        dispatch_async(queue, ^{
            NSLog(@&quot;下载资源：%i&quot;,i);
            sleep(2);
            dispatch_semaphore_signal(semaphore);
        });
    }
}

2016-02-26 14:04:33.392 FL_GCD_DEMO[5713:3848434] 下载资源：1
2016-02-26 14:04:33.392 FL_GCD_DEMO[5713:3848431] 下载资源：0
2016-02-26 14:04:35.397 FL_GCD_DEMO[5713:3848434] 下载资源：2
2016-02-26 14:04:35.397 FL_GCD_DEMO[5713:3848431] 下载资源：3
2016-02-26 14:04:37.400 FL_GCD_DEMO[5713:3848434] 下载资源：5
2016-02-26 14:04:37.400 FL_GCD_DEMO[5713:3848431] 下载资源：4
2016-02-26 14:04:39.401 FL_GCD_DEMO[5713:3848431] 下载资源：6
2016-02-26 14:04:39.401 FL_GCD_DEMO[5713:3848434] 下载资源：7
2016-02-26 14:04:41.406 FL_GCD_DEMO[5713:3848434] 下载资源：9
2016-02-26 14:04:41.406 FL_GCD_DEMO[5713:3848431] 下载资源：8
</code></pre><p>说明:dispatch_semaphore_create(2)创建了一个单位为2的信号量<br>dispatch_semaphore_wait()会消耗一个单位<br>ispatch_semaphore_signal()会增加一个单位<br>而dispatch_semaphore_create(2)中传入的“2”决定了这个信号量最多包含2个单位。<br>dispatch_semaphore_wait()中的参数2DISPATCH_TIME_FOREVER表示当信号量单位变为0个，则使得代码的执行停止在当前位置不再继续下去，直到收到signal使得单位大于0，才继续往下执行。<br>在上述代码中，每执行一次下载会占用一个单位，下载完成后通过signal告诉wait可以继续向下执行代码，从而控制同时进行的下载数量。</p>
<h1 id="WWDC-2016-What’s-new-in-GCD-swift"><a href="#WWDC-2016-What’s-new-in-GCD-swift" class="headerlink" title="WWDC 2016 What’s new in GCD(swift)"></a>WWDC 2016 What’s new in GCD(swift)</h1><p>Dispatch Queues execute work items in FIFO order，including two kind of execution</p>
<p>Asynchronous ：可以先加入队列，将来再执行</p>
<p>Synchronous：必须执行完才到下一个</p>
<pre><code>let queue = DispatchQueue(label: &quot;com.example.imagetransform&quot;)
queue.async {
let smallImage = image.resize(to: rect)
DispatchQueue.main.async {
imageView.image = smallImage
}
}
</code></pre><h2 id="Getting-Work-Off-Your-Main-Thread"><a href="#Getting-Work-Off-Your-Main-Thread" class="headerlink" title="Getting Work Off Your Main Thread"></a>Getting Work Off Your Main Thread</h2><p>Create a Dispatch Queue to which you submit work</p>
<p>Dispatch Queues execute work items in FIFO order</p>
<p>Use .async to execute your work on the queue</p>
<p>Dispatch main queue executes all items on the main thread</p>
<p>Simple to chain work between queues</p>
<pre><code>let queue = DispatchQueue(label: &quot;com.example.imagetransform&quot;)
queue.async {
let smallImage = image.resize(to: rect)
DispatchQueue.main.async {
imageView.image = smallImage
}
}
</code></pre><h2 id="Grouping-Work-Together"><a href="#Grouping-Work-Together" class="headerlink" title="Grouping Work Together"></a>Grouping Work Together</h2><p><img src="https://www.dropbox.com/s/3m8l3xcxrstwb98/2016100501.png?dl=1" alt=""></p>
<h2 id="Choosing-a-Quality-of-Service"><a href="#Choosing-a-Quality-of-Service" class="headerlink" title="Choosing a Quality of Service"></a>Choosing a Quality of Service</h2><p><img src="https://www.dropbox.com/s/l6qskn8z4z37kzd/2016100502.png?dl=1" alt=""></p>
<h2 id="Using-Quality-of-Service-Classes"><a href="#Using-Quality-of-Service-Classes" class="headerlink" title="Using Quality of Service Classes"></a>Using Quality of Service Classes</h2><p>Use .async to submit work with a specific QoS class</p>
<p>Dispatch helps resolve priority inversions</p>
<p>Create single-purpose queues with a specific QoS class</p>
<pre><code>queue.async(qos: .background) {
print(&quot;Maintenance work&quot;)
}
queue.async(qos: .userInitiated) {
print(“Button tapped”)
}
</code></pre><p>摘自 </p>
<ol>
<li><a href="http://www.jianshu.com/p/2d57c72016c6" target="_blank" rel="external">iOS多线程–彻底学会多线程之GCD</a></li>
<li><a href="http://www.jianshu.com/p/5efa458c9340" target="_blank" rel="external">GCD（Grand Central Dispatch）快速上手</a></li>
<li><a href="http://www.jianshu.com/p/7efbecee6af8" target="_blank" rel="external">GCD in Swift 3</a></li>
<li><a href="http://www.jianshu.com/p/66eb7e2a8b0f" target="_blank" rel="external">GCD for Swift</a></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/28/Grand-Central-Dispatch/" itemprop="url">
                  Grand_Central_Dispatch
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-28T17:02:59+10:00" content="2016-09-28">
              2016-09-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/IT/" itemprop="url" rel="index">
                    <span itemprop="name">IT</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/28/Grand-Central-Dispatch/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/09/28/Grand-Central-Dispatch/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Closure"><a href="#Closure" class="headerlink" title="Closure"></a>Closure</h1><h2 id="Closure-is-a-first-class-citizen-of-the-language"><a href="#Closure-is-a-first-class-citizen-of-the-language" class="headerlink" title="Closure is a first class citizen of the language"></a>Closure is a first class citizen of the language</h2><ul>
<li>assign them to variables or constants,</li>
<li>put then inside arrays or dictionaries</li>
<li>return them as the result of a function or closure</li>
<li>and even receive them as parameters of another function or closure!</li>
</ul>
<pre><code>let f = { (x:Int) -&gt; Int in
    return x + 42
}

f(89)

let closures = [
    f,                                  // our previous closure
    {(x:Int) -&gt; Int in return x * 2},   // a new Int -&gt; Int closure
    {x in return x - 8},                // no need for the type of the closure!
    {(x:Int) in x * x},                 // no need for return if only one line
    {$0 * 42}                           // access parameter by position instead of name
]

for fn in closures {
fn(42)
}
</code></pre><h2 id="Functions-and-closures-are-the-same-thing"><a href="#Functions-and-closures-are-the-same-thing" class="headerlink" title="Functions and closures are the same thing"></a>Functions and closures are the same thing</h2><p>Actually, when the compiler finds a function declaration such as foo, it will take the following steps:</p>
<ul>
<li>Create a closure that takes an Int and returns 42 plus that Int.</li>
<li>Then, assigns this closure to a constant called foo</li>
</ul>
<pre><code>func foo(x:Int) -&gt; Int {
    return 42 + x
}

let bar = { (x: Int) -&gt; Int in
    return 42 + x
}
</code></pre><p>add a few functions to an array and then call them</p>
<pre><code>func larry(x:Int) -&gt; Int {
    return x * x
}

func curly(n:Int) -&gt; Int {
    return n * (n - 1)
}

func moe(n:Int) -&gt; Int {
    return n * (n - 1) * (n - 2)
}

var stooges = [larry, curly, moe]

for stooge in stooges {
    stooge(42)
}

stooges.append(bar)
for each in stooges {
    each(42)
}
</code></pre><h2 id="Typealias-amp-Capture-value"><a href="#Typealias-amp-Capture-value" class="headerlink" title="Typealias &amp; Capture value"></a>Typealias &amp; Capture value</h2><pre><code>typealias IntMaker = (Void) -&gt; Int
</code></pre><p>Functions and closure capture variables defined before the closure or function is defined.</p>
<pre><code>func makeCounter() -&gt; IntMaker {
    var n = 0

    // Functions within functions?
    // Yes we can!
    func adder() -&gt; Integer {
        n = n + 1
        return n
    }
    return adder
}

let counter1 = makeCounter()
let counter2 = makeCounter()

counter1() //1
counter1() //2
counter1() //3
</code></pre><p>each closure has its own copy of the environment (the values of all variables that were captured).</p>
<pre><code>counter2() //1
</code></pre><h1 id="GCD"><a href="#GCD" class="headerlink" title="GCD"></a>GCD</h1><h2 id="Hiding-threads"><a href="#Hiding-threads" class="headerlink" title="Hiding threads"></a>Hiding threads</h2><ul>
<li><p>Threads are inherently complex and dangerous</p>
</li>
<li><p>GCD makes asynchronous programming easier and safer by hiding threads within the concept of a queue of closure from the developer</p>
</li>
<li><p>Blades are inherently dangerous ,add handles to make for safer knives</p>
</li>
</ul>
<h2 id="Types-of-queues"><a href="#Types-of-queues" class="headerlink" title="Types of queues"></a>Types of queues</h2><h3 id="Serial-or-synchronous-queue-predictable"><a href="#Serial-or-synchronous-queue-predictable" class="headerlink" title="Serial or synchronous queue - predictable"></a>Serial or synchronous queue - predictable</h3><ul>
<li><p>Every closure gets to run when it reaches the end of the queue</p>
</li>
<li><p>The order in which closures run is predictable</p>
</li>
<li><p>Still have concurrency ,each queue will run on its own threads and will not block each other</p>
</li>
</ul>
<h3 id="Concurrent-or-Asynchronous-queue-unpredictable"><a href="#Concurrent-or-Asynchronous-queue-unpredictable" class="headerlink" title="Concurrent or Asynchronous queue - unpredictable"></a>Concurrent or Asynchronous queue - unpredictable</h3><ul>
<li><p>Have several threads pickup closures at any point of the queue for running</p>
</li>
<li><p>The order in which closures run is not predictable</p>
</li>
</ul>
<h3 id="Main-queue"><a href="#Main-queue" class="headerlink" title="Main queue"></a>Main queue</h3><ul>
<li><p>handles the UI of your app</p>
</li>
<li><p>You should never run code that blocks on this queue</p>
</li>
</ul>
<h2 id="Main-function-in-GCD"><a href="#Main-function-in-GCD" class="headerlink" title="Main function in GCD"></a>Main function in GCD</h2><h3 id="create-a-queue"><a href="#create-a-queue" class="headerlink" title="create a queue"></a>create a queue</h3><p>Represents a queue</p>
<pre><code>dispatch_queue_t
</code></pre><p>Ceate a queue from scratch,To specify serial, just pass dispatch_queue_serial or nil</p>
<pre><code>dispatch_queue_create(name,serial/concurrent)
</code></pre><h3 id="Global-queues"><a href="#Global-queues" class="headerlink" title="Global queues"></a>Global queues</h3><p>Use existing one queue instead of creating new queues</p>
<pre><code>QOS_CLASS_USER_INTERACTIVE //top priority 

QOS_CLASS_USER_INITIATED   //regular priority 

QOS_CLASS_BACKGROUND    //low

QOS_CLASS_UTILITY //lowes 
</code></pre><p>access those global queues with function </p>
<pre><code>dispatch_get_global_queue
</code></pre><h3 id="Main-queue-1"><a href="#Main-queue-1" class="headerlink" title="Main queue"></a>Main queue</h3><p>get the main queue</p>
<pre><code>dispatch_get_main_queue()
</code></pre><h3 id="Add-a-closure-to-a-queue"><a href="#Add-a-closure-to-a-queue" class="headerlink" title="Add a closure to a queue"></a>Add a closure to a queue</h3><ul>
<li>the code inside the queue will run sometime in the immediate future</li>
<li>the exact time will depend on how many closures already waiting in the queue and the priority of the queue </li>
<li>dispatch_async adds your closures to each queue and return imediately</li>
</ul>
<p>Add a closure to a queue</p>
<pre><code>dispatch_async ()
</code></pre><p>Example 1</p>
<pre><code>let q = dispatch_get_global_queue(QOS_CLASS_USER_INTERACTIVE,0)

//Imediately return and add the block to the q ,then run in the near future 
dispatch_async(q){
    () -&gt; Void in
    print(&quot;tic&quot;)
}

print (&quot;tac&quot;) //this run first
</code></pre><p>Example 2</p>
<pre><code>//cannot predict order the code run below of each queue

let q1 = dispatch_queue_create(&quot;queue1&quot;,nil)
let q2 = dispatch_queue_create(&quot;queue1&quot;,nil)
let q3 = dispatch_queue_create(&quot;queue1&quot;,nil)

dispatch_async(q1){ ()-&gt;Void in
print(1)
}

dispatch_async(q2){ ()-&gt;Void in
print(2)
}

dispatch_async(q3){ ()-&gt;Void in
print(3)
}

print(&quot;end&quot;) //run first
</code></pre><h3 id="UIKIT-amp-CoreData"><a href="#UIKIT-amp-CoreData" class="headerlink" title="UIKIT &amp; CoreData"></a>UIKIT &amp; CoreData</h3><ul>
<li><p>when the framework can run in the background it is said to be thread safe </p>
</li>
<li><p>cannot run anything from UIKit in the background</p>
</li>
</ul>
<pre><code>//maybe crash , uikit should run in Main queue

let downloadQueue = dispatch_queue_create(&quot;download&quot;,nil)

dispatch_async(downloadQueue){()-&gt; Void in 

let imgData = NSData (contentsOfURL:url!)

let image = UIImage(data:imgData!)

self.photoViewimage = image

}
</code></pre><h2 id="Synchronous-download"><a href="#Synchronous-download" class="headerlink" title="Synchronous download"></a>Synchronous download</h2><pre><code>// Get the URL for the image
let url = NSURL(string: BigImages.seaLion.rawValue)

// Obtain the NSData with the image
let imgData = NSData(contentsOfURL: url!)

// Turn it into a UIImage
let image = UIImage(data: imgData!)

// Display it
photoView.image = image
</code></pre><p>Refactor code by if-let </p>
<pre><code>if let url = NSURL(string: BigImages.seaLion.rawValue),
    let imgData = NSData(contentsOfURL: url),
    let image = UIImage(data: imgData){

    // Display it
    photoView.image = image
}
</code></pre><h2 id="Asynchronous-download"><a href="#Asynchronous-download" class="headerlink" title="Asynchronous download"></a>Asynchronous download</h2><p>Not all of UIkit is thread and save.There are a few exceptions, such as UIImage<br>All the visual stuff, the views are unsaved<br>if name end view, it must be main queue </p>
<pre><code>@IBAction func simpleAsynchronousDownload(sender: UIBarButtonItem) {

        let url = NSURL(string: BigImages.shark.rawValue)

        // create a queue
        let downloadQueue = dispatch_queue_create(&quot;download&quot;, nil)

        // add a closure that encapsulates the blocking operation
        // run it asynchronously: some time in the near future

        dispatch_async(downloadQueue) { () -&gt; Void in

            // Obtain the NSData with the image
            let imgData = NSData(contentsOfURL: url!)

            // Turn it into a UIImage
            let image = UIImage(data: imgData!)

            // Run the code that updates the UI in the main queue!
            dispatch_async(dispatch_get_main_queue(), { () -&gt; Void in
                // Display it
                self.photoView.image = image
            })
        }
    }
</code></pre><h2 id="Completion-Closure"><a href="#Completion-Closure" class="headerlink" title="Completion Closure"></a>Completion Closure</h2><p>It is a good practice to make sure that always all your completion handlers run in the main queue</p>
<pre><code>    func withBigImage(completionHandler handler: (image: UIImage) -&gt; Void){

    dispatch_async(dispatch_get_global_queue(QOS_CLASS_USER_INITIATED, 0)) { () -&gt; Void in

        // get the url
        // get the NSData
        // turn it into a UIImage

        if let url = NSURL(string: BigImages.whale.rawValue), let imgData = NSData(contentsOfURL: url), let img = UIImage(data: imgData) {

            // run the completion block
            // always in the main queue, just in case!

            dispatch_async(dispatch_get_main_queue(), { () -&gt; Void in
                handler(image: img)
            })
        }
    }
}
</code></pre><h2 id="Async-amp-Sync"><a href="#Async-amp-Sync" class="headerlink" title="Async &amp; Sync"></a>Async &amp; Sync</h2><p>doesn’t wait for the closure to finish ,and moves on Always use until you know very well what you are doing</p>
<pre><code>dispatch_async()
</code></pre><p>won’t return immediately.waits until the closure is done ,could easily get stalled!</p>
<pre><code>dispatch_sync()
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/28/Grand-Central-Dispatch-Tutorial-for-Swift1/" itemprop="url">
                  Grand_Central_Dispatch_Tutorial_for_Swift1
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-28T15:34:43+10:00" content="2016-09-28">
              2016-09-28
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/28/Grand-Central-Dispatch-Tutorial-for-Swift1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/09/28/Grand-Central-Dispatch-Tutorial-for-Swift1/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Term"><a href="#Term" class="headerlink" title="Term"></a>Term</h1><p>GCD is the marketing name for libdispatch</p>
<h2 id="Serial-vs-Concurrent"><a href="#Serial-vs-Concurrent" class="headerlink" title="Serial vs. Concurrent"></a>Serial vs. Concurrent</h2><p>These terms describe when tasks are executed with respect to each other.</p>
<p>Tasks executed serially are always executed one at a time.</p>
<p>Tasks executed concurrently might be executed at the same time.</p>
<h2 id="Synchronous-vs-Asynchronous-同步和异步"><a href="#Synchronous-vs-Asynchronous-同步和异步" class="headerlink" title="Synchronous vs. Asynchronous(同步和异步)"></a>Synchronous vs. Asynchronous(同步和异步)</h2><p>These terms describe when a function will return control to the caller, and how much work will have been done by that point.</p>
<p>A synchronous function returns only after the completion of a task that it orders.</p>
<p>An asynchronous function, on the other hand, returns immediately, ordering the task to be done but not waiting for it. Thus, an asynchronous function does not block the current thread of execution from proceeding on to the next function.</p>
<h2 id="Critical-Section"><a href="#Critical-Section" class="headerlink" title="Critical Section"></a>Critical Section</h2><p>This is a piece of code that must not be executed concurrently, which might manipulates a shared resource</p>
<h2 id="Race-Condition"><a href="#Race-Condition" class="headerlink" title="Race Condition"></a>Race Condition</h2><h2 id="Deadlock"><a href="#Deadlock" class="headerlink" title="Deadlock"></a>Deadlock</h2><p>两个thread互相等待对方完成，陷入僵局</p>
<h2 id="Thread-Safe"><a href="#Thread-Safe" class="headerlink" title="Thread Safe"></a>Thread Safe</h2><p>Thread safe code can be safely called from multiple threads or concurrent tasks without causing any problems</p>
<p>设定常量是线程安全的，变量不一定安全，因为可能被其他线程的所改变值</p>
<p>Variables and data structures that are mutable and not inherently thread-safe should only be accessed from one thread at a time.</p>
<h2 id="Context-Switch"><a href="#Context-Switch" class="headerlink" title="Context Switch"></a>Context Switch</h2><p>A context switch is the process of storing and restoring execution state when you switch between executing different threads on a single process.</p>
<h2 id="Concurrency-vs-Parallelism"><a href="#Concurrency-vs-Parallelism" class="headerlink" title="Concurrency vs Parallelism"></a>Concurrency vs Parallelism</h2><p>Multi-core devices execute multiple threads at the same time via parallelism</p>
<p>Single-cored devices must run a thread, perform a context switch</p>
<p>Parallelism requires concurrency, but concurrency does not guarantee parallelism.</p>
<h1 id="Queues"><a href="#Queues" class="headerlink" title="Queues"></a>Queues</h1><p>GCD provides dispatch queues to handle submitted tasks; these queues manage the tasks you provide to GCD and execute those tasks in FIFO order</p>
<h2 id="Serial-Queues"><a href="#Serial-Queues" class="headerlink" title="Serial Queues"></a>Serial Queues</h2><p>executes only one task at a time</p>
<p><img src="https://www.dropbox.com/s/3ghgkn5eg52vd0t/2016092801.png?dl=1" alt="1"></p>
<h2 id="Concurrent-Queues"><a href="#Concurrent-Queues" class="headerlink" title="Concurrent Queues"></a>Concurrent Queues</h2><p>The decision of when to start a task is entirely up to GCD.</p>
<p><img src="https://www.dropbox.com/s/ivkbyp2306tqry4/2016092802.png?dl=1" alt="2"></p>
<h2 id="Queue-Types"><a href="#Queue-Types" class="headerlink" title="Queue Types"></a>Queue Types</h2><p>You have at least five queues at your disposal: the main queue, four global dispatch queues, plus any custom queues</p>
<ul>
<li><p>Main queue:which is the only thread allowed to update your UI.</p>
</li>
<li><p>QOS_CLASS_USER_INTERACTIVE</p>
</li>
<li><p>QOS_CLASS_USER_INITIATED</p>
</li>
<li><p>QOS_CLASS_UTILITY</p>
</li>
<li><p>QOS_CLASS_BACKGROUND</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/default_avatar.jpg"
               alt="Jack Liu" />
          <p class="site-author-name" itemprop="name">Jack Liu</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">109</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>
          
          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">36</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jack Liu</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'cowboyTech';
      var disqus_identifier = 'index.html';
      var disqus_title = '';
      var disqus_url = '';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
    </script>
  



  
  
  

  
  


</body>
</html>
